<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"tylerastro.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="å‰è¨€æƒ³åƒå¤©æ–‡äº‹ä»¶éƒ½æ˜¯ä¸€ç¬é–“ç™¼ç”Ÿçš„ï¼Œåƒæ˜¯Blackhole merger, Supernova, flare events and so on. é€™äº›äº‹ä»¶çš„ç´€éŒ„éƒ½æ˜¯å¾ˆé›£èƒ½å¯è²´çš„è³‡æ–™ï¼Œè‹¥æ˜¯è¦å®Œæ•´ç´€éŒ„æ›´æ˜¯ç¨€æœ‰ï¼Œæˆ‘å€‘åªèƒ½åœ¨æ¥åˆ°é€šçŸ¥å¾Œç›¡é‡å»åšfollow-up observationã€‚æ­¤æ™‚è‹¥æœ‰å€‹ç³»çµ±å¯ä»¥æ¥æ”¶ä¸¦ä¸”ç«‹åˆ»ç™¼é€åˆ°å„å€‹å¤©æ–‡å°ï¼Œé‚£éº¼é€™äº›é›£èƒ½å¯è²´çš„ç¾è±¡æˆ‘å€‘å°±å¯ä»¥é€²ä¸€æ­¥äº†è§£ã€‚ TOMå°±æ˜¯ç‚ºäº†è™•ç†é€™äº›ç›®æ¨™èˆ‡è§€">
<meta property="og:type" content="article">
<meta property="og:title" content="Django + Docker -&gt; Deployment with Nginx, Gunicorn and PostgreSQL">
<meta property="og:url" content="https://tylerastro.github.io/2023/07/03/Django/index.html">
<meta property="og:site_name" content="Tyler&#39;s Blog">
<meta property="og:description" content="å‰è¨€æƒ³åƒå¤©æ–‡äº‹ä»¶éƒ½æ˜¯ä¸€ç¬é–“ç™¼ç”Ÿçš„ï¼Œåƒæ˜¯Blackhole merger, Supernova, flare events and so on. é€™äº›äº‹ä»¶çš„ç´€éŒ„éƒ½æ˜¯å¾ˆé›£èƒ½å¯è²´çš„è³‡æ–™ï¼Œè‹¥æ˜¯è¦å®Œæ•´ç´€éŒ„æ›´æ˜¯ç¨€æœ‰ï¼Œæˆ‘å€‘åªèƒ½åœ¨æ¥åˆ°é€šçŸ¥å¾Œç›¡é‡å»åšfollow-up observationã€‚æ­¤æ™‚è‹¥æœ‰å€‹ç³»çµ±å¯ä»¥æ¥æ”¶ä¸¦ä¸”ç«‹åˆ»ç™¼é€åˆ°å„å€‹å¤©æ–‡å°ï¼Œé‚£éº¼é€™äº›é›£èƒ½å¯è²´çš„ç¾è±¡æˆ‘å€‘å°±å¯ä»¥é€²ä¸€æ­¥äº†è§£ã€‚ TOMå°±æ˜¯ç‚ºäº†è™•ç†é€™äº›ç›®æ¨™èˆ‡è§€">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tylerastro.github.io/2023/07/03/Django/Moby-logo.png">
<meta property="og:image" content="https://tylerastro.github.io/2023/07/03/Django/runserver.png">
<meta property="og:image" content="https://tylerastro.github.io/2023/07/03/Django/runserver.png">
<meta property="article:published_time" content="2023-07-03T13:15:13.000Z">
<meta property="article:modified_time" content="2023-07-03T13:15:13.679Z">
<meta property="article:author" content="Han Tang Lin">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="Deployment">
<meta property="article:tag" content="Web Development">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tylerastro.github.io/2023/07/03/Django/Moby-logo.png">


<link rel="canonical" href="https://tylerastro.github.io/2023/07/03/Django/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://tylerastro.github.io/2023/07/03/Django/","path":"2023/07/03/Django/","title":"Django + Docker -> Deployment with Nginx, Gunicorn and PostgreSQL"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Django + Docker -> Deployment with Nginx, Gunicorn and PostgreSQL | Tyler's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Tyler's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTML-%E6%A8%A1%E6%9D%BF"><span class="nav-number">2.</span> <span class="nav-text">HTML æ¨¡æ¿</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HTML"><span class="nav-number">2.1.</span> <span class="nav-text">HTML</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSS"><span class="nav-number">2.2.</span> <span class="nav-text">CSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SASS-SCSS"><span class="nav-number">2.2.1.</span> <span class="nav-text">SASS&#x2F;SCSS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker"><span class="nav-number">3.</span> <span class="nav-text">Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Installation"><span class="nav-number">3.1.</span> <span class="nav-text">Installation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Images"><span class="nav-number">3.2.</span> <span class="nav-text">Images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Containers"><span class="nav-number">3.3.</span> <span class="nav-text">Containers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Volumes"><span class="nav-number">3.4.</span> <span class="nav-text">Volumes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dockerfile"><span class="nav-number">3.5.</span> <span class="nav-text">Dockerfile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-example"><span class="nav-number">3.6.</span> <span class="nav-text">Docker example</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Django"><span class="nav-number">4.</span> <span class="nav-text">Django</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Installation-1"><span class="nav-number">4.1.</span> <span class="nav-text">Installation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Start-your-project"><span class="nav-number">4.2.</span> <span class="nav-text">Start your project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Settings"><span class="nav-number">4.3.</span> <span class="nav-text">Settings</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#manage-py"><span class="nav-number">4.3.1.</span> <span class="nav-text">manage.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asgi-py"><span class="nav-number">4.3.2.</span> <span class="nav-text">asgi.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#settings-py"><span class="nav-number">4.3.3.</span> <span class="nav-text">settings.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#urls-py"><span class="nav-number">4.3.4.</span> <span class="nav-text">urls.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Start-your-Apps"><span class="nav-number">4.4.</span> <span class="nav-text">Start your Apps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#views-py"><span class="nav-number">4.4.1.</span> <span class="nav-text">views.py</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HttpResponse"><span class="nav-number">4.4.1.1.</span> <span class="nav-text">HttpResponse</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#render"><span class="nav-number">4.4.1.2.</span> <span class="nav-text">render</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Handling-form-post"><span class="nav-number">4.4.1.3.</span> <span class="nav-text">Handling form post</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#urls-py-1"><span class="nav-number">4.4.2.</span> <span class="nav-text">urls.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#models-py"><span class="nav-number">4.4.3.</span> <span class="nav-text">models.py</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deployment"><span class="nav-number">5.</span> <span class="nav-text">Deployment</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Django-setup"><span class="nav-number">5.1.</span> <span class="nav-text">Django setup</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-file"><span class="nav-number">5.2.</span> <span class="nav-text">Docker file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-compose"><span class="nav-number">5.3.</span> <span class="nav-text">Docker-compose</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Postgres-service"><span class="nav-number">5.4.</span> <span class="nav-text">Postgres service</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-compose-services"><span class="nav-number">5.4.1.</span> <span class="nav-text">docker-compose services</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#settings-py-1"><span class="nav-number">5.4.2.</span> <span class="nav-text">settings.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Update-Dockerfile"><span class="nav-number">5.4.3.</span> <span class="nav-text">Update Dockerfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Django-Migrate"><span class="nav-number">5.4.4.</span> <span class="nav-text">Django Migrate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Flow-control"><span class="nav-number">5.4.5.</span> <span class="nav-text">Flow control</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gunicorn"><span class="nav-number">5.5.</span> <span class="nav-text">Gunicorn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-compose-yml"><span class="nav-number">5.5.1.</span> <span class="nav-text">docker-compose.yml</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginx"><span class="nav-number">5.6.</span> <span class="nav-text">Nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker-compose"><span class="nav-number">5.6.1.</span> <span class="nav-text">docker-compose</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#conf-files"><span class="nav-number">5.6.2.</span> <span class="nav-text">conf files</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Dockerfile-1"><span class="nav-number">5.6.2.1.</span> <span class="nav-text">Dockerfile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nginx-conf"><span class="nav-number">5.6.2.2.</span> <span class="nav-text">nginx.conf</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Get-online"><span class="nav-number">5.7.</span> <span class="nav-text">Get online</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Debug"><span class="nav-number">5.7.1.</span> <span class="nav-text">Debug</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">6.</span> <span class="nav-text">References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Han Tang Lin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Tylerastro" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Tylerastro" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:w39398898@gmail.com" title="E-Mail â†’ mailto:w39398898@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://astrocodertyler.medium.com/" title="Medium â†’ https:&#x2F;&#x2F;astrocodertyler.medium.com" rel="noopener" target="_blank"><i class="fab fa-medium fa-fw"></i>Medium</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://tylerastro.github.io/2023/07/03/Django/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Han Tang Lin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tyler's Blog">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Django + Docker -> Deployment with Nginx, Gunicorn and PostgreSQL | Tyler's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Django + Docker -> Deployment with Nginx, Gunicorn and PostgreSQL
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-07-03 21:15:13" itemprop="dateCreated datePublished" datetime="2023-07-03T21:15:13+08:00">2023-07-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>24k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>22 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æƒ³åƒå¤©æ–‡äº‹ä»¶éƒ½æ˜¯ä¸€ç¬é–“ç™¼ç”Ÿçš„ï¼Œåƒæ˜¯Blackhole merger, Supernova, flare events and so on. é€™äº›äº‹ä»¶çš„ç´€éŒ„éƒ½æ˜¯å¾ˆé›£èƒ½å¯è²´çš„è³‡æ–™ï¼Œè‹¥æ˜¯è¦å®Œæ•´ç´€éŒ„æ›´æ˜¯ç¨€æœ‰ï¼Œæˆ‘å€‘åªèƒ½åœ¨æ¥åˆ°é€šçŸ¥å¾Œç›¡é‡å»åšfollow-up observationã€‚æ­¤æ™‚è‹¥æœ‰å€‹ç³»çµ±å¯ä»¥æ¥æ”¶ä¸¦ä¸”ç«‹åˆ»ç™¼é€åˆ°å„å€‹å¤©æ–‡å°ï¼Œé‚£éº¼é€™äº›é›£èƒ½å¯è²´çš„ç¾è±¡æˆ‘å€‘å°±å¯ä»¥é€²ä¸€æ­¥äº†è§£ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://tom-toolkit.readthedocs.io/en/stable/">TOM</a>å°±æ˜¯ç‚ºäº†è™•ç†é€™äº›ç›®æ¨™èˆ‡è§€æ¸¬çš„å¹³å°ï¼Œè—‰ç”±PythonçŸ¥åçš„Djangoæ¡†æ¶ä¾†åšè™•ç†ã€‚é€™ç¯‡æ–‡ç« ç›®æ¨™æ¶µè“‹å¾å¯«HTMLçš„æ¨¡æ¿é–‹å§‹ï¼Œè—‰ç”±Djangoæ¶è¨­æ¸¬è©¦ç”¨ä¼ºæœå™¨ï¼Œæ¥è‘—åˆ©ç”¨DockeræŠŠæ•´å€‹æ‰“åŒ…èµ·ä¾†æ”¾åˆ°ä¼ºæœå™¨ä¸Šé‹è¡Œã€‚</p>
<span id="more"></span>

<h1 id="HTML-æ¨¡æ¿"><a href="#HTML-æ¨¡æ¿" class="headerlink" title="HTML æ¨¡æ¿"></a>HTML æ¨¡æ¿</h1><p>æœ¬èº«ä¸¦éåšè¨­è¨ˆæˆ–CSå‡ºèº«ï¼Œé€™éƒ¨åˆ†æˆ‘éƒ½æ˜¯è—‰ç”±<a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.getmimo&hl=zh_TW&gl=US">Mimo</a>ä»¥åŠYoutubeä¾†åšå­¸ç¿’ç¶²é é–‹ç™¼ã€‚æˆ‘ä¸€ç›´èªç‚ºå­¸ç¿’ç¨‹å¼éƒ½æ˜¯èˆˆè¶£å°å‘ï¼Œæœ‰ä¸€å€‹æƒ³å®Œæˆçš„äº‹æƒ…ï¼Œç„¶å¾Œå»å­¸ç¿’éœ€è¦çš„å·¥å…·ã€‚</p>
<hr>
<p>å»¢è©±é‚£éº¼å¤šï¼Œæˆ‘æœƒå»ºè­°å¦‚æœæ²’ç¶“é©—çš„äººæˆ–åˆå­¸è€…ï¼Œå¯ä»¥è·Ÿæˆ‘ä¸€æ¨£å…ˆæ‰¾Youtubeå½±ç‰‡ï¼Œæ¯”å¦‚èªªé€™ç¨®<a target="_blank" rel="noopener" href="https://youtu.be/lAOkx2yZESY">How To Make Responsive Website Design Using HTML And CSS Step By Step</a>ã€‚é€éæŠ„ä½œæ¥­çš„éç¨‹ä½ æœƒæ…¢æ…¢äº†è§£æ¯ä¸€æ­¥é©Ÿåœ¨åšä»€éº¼ã€‚è—‰ç”±å¤§é‡æŠ„ä½œæ¥­çš„éç¨‹ä½ ä¹Ÿæœƒæ…¢æ…¢çŸ¥é“è¦å¦‚ä½•æ‹¼æ¹Šå‡ºè‡ªå·±æƒ³è¦çš„ç¶²é ã€‚</p>
<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><p>å¦‚ä½•å»ºæ§‹ä¸€å€‹ç¶²ç«™ï¼Ÿä¸€å€‹ç¶²ç«™æœƒç”±ä¸€å€‹HTMLæª”æ¡ˆæ­é…CSSä»¥åŠJavaScriptçµ„æˆï¼Œå¾Œå…©è€…æ˜¯é¸ä¿®ã€‚</p>
<ol>
<li>HTML -&gt; å­˜æ”¾ç¶²é å¤§é‡æ–‡æœ¬ï¼Œä»¥åŠæ’ç‰ˆè³‡è¨Šã€‚</li>
<li>CSS  -&gt; æ ¹æ“š<strong>tag</strong>ä¾†åšä¿®é£¾ï¼Œè«–åŠé¡è‰²ï¼Œå¤§å°ï¼ŒèƒŒæ™¯ï¼Œå‹•ä½œç­‰ç­‰ã€‚</li>
<li>JS   -&gt; JavaScriptè™•ç†äº’å‹•å¼ä»‹é¢ï¼Œä»»ä½•æœ‰äº’å‹•ï¼Œæœ‰å›æ‡‰çš„åŠŸèƒ½ã€‚éƒ¨åˆ†åŠŸèƒ½å¯èƒ½ç”±JSä»¥åŠCSSå…©è€…éƒ½å¯ä»¥é”æˆã€‚</li>
</ol>
<p>åœ¨HTMLè£¡é¢ï¼Œæˆ‘å€‘æœƒä»¥é–‹é ­<code>&lt;!DOCTYPE html&gt;</code>å®£å‘Šæ–‡ä»¶é¡å‹ï¼Œä½†ç¾åœ¨å…¶å¯¦ä¸å¤ªéœ€è¦ç®¡ï¼Œè¨˜å¾—åœ¨é–‹é ­æ“ºä¸Šå°±å¥½ã€‚<br>æ¥è‘—æˆ‘å€‘æœƒä»¥å„å¼å„æ¨£çš„æ¨™ç±¤ä¾†å­˜æ”¾æˆ‘å€‘çš„å…§å®¹ã€‚åƒæ˜¯æˆ‘å€‘è¦åœ¨ç¶²é ä¸Šå‘ˆç¾çš„å…§å®¹å°±æœƒæ”¾åœ¨<code>html</code>æ¨™ç±¤ä¸Šï¼Œæ¨™ç±¤æœƒä»¥<code>&lt;html&gt;</code>,<code>&lt;/html&gt;</code>è¡¨ç¤ºé–‹é ­åŠçµæŸã€‚<br>èˆ‰ä¸€åä¸‰ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥ç”¨<code>title</code>æ¨™ç±¤ä¾†å­˜æ”¾æˆ‘å€‘è¦åœ¨ç¶²é tabä¸Šæ‰€å‘ˆç¾çš„ç¶²é åç¨±ï¼š<code>&lt;title&gt;This is my page&lt;/title&gt;</code>ã€‚</p>
<p>ç„¶è€Œä¹Ÿä¸æ˜¯å…¨éƒ¨æ¨™ç±¤éƒ½æœƒæœ‰é–‹é ­åŠçµæŸï¼Œä»¥ä¸‹çš„ä¾‹å­ä¹Ÿå°±èªªæ˜äº†åƒæ˜¯<code>img</code>å°±æ²’æœ‰çµæŸæ¨™ç±¤ã€‚<br>åœ¨ä½¿ç”¨VScodeå¯«å…¥HTMLæ–‡ä»¶æ™‚ï¼Œæ¨™ç±¤æœƒè‡ªå‹•ç”¢ç”Ÿä¸€å°ï¼Œæ¸›å°‘ä¸å¿…è¦çš„debugç’°ç¯€ã€‚</p>
<figure class="highlight xml"><figcaption><span>Sample</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>This is my page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;myPicture.jpeg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;My image&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p><a target="_blank" rel="noopener" href="https://code.tutsplus.com/zh-hant/tutorials/the-30-css-selectors-you-must-memorize--net-16048">30å€‹ä½ å¿…é ˆè¨˜ä½çš„CSSé¸æ“‡å™¨</a></p>
<p>CSSï¼Œç‚ºå°‡æ•´ç¯‡ç¶²é çš„é¢¨æ ¼å¦å¤–å¯«æˆæª”æ¡ˆï¼Œåœ¨HTMLè£¡é¢æœƒæ’å…¥<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</code>ä¾†å°å…¥æˆ‘å€‘çš„é¢¨æ ¼ã€‚<br>é‚£éº¼å°å…¥æ¨¡å¼æœƒåƒè€ƒæˆ‘å€‘åœ¨HTMLè£¡æ‰€çµ¦çš„æ¨™ç±¤ä»¥åŠclass. ç•¢ç«Ÿå¦‚æœåªåƒè€ƒæ¨™ç±¤ï¼Œæˆ‘ä¸ä¸€å®šæ•´ç¯‡çš„h1æ¨™é¡Œéƒ½æƒ³è¦ä¸€æ¨£çš„é¢¨æ ¼ï¼Œæœ‰å¯èƒ½åœ¨æŸç« ç¯€è£¡é¢æˆ‘å€‘æƒ³è¦ä¸åŒçš„èƒŒæ™¯é¡è‰²æˆ–å‹•ç•«ç­‰ç­‰ã€‚</p>
<p>æˆ‘å€‘åƒè€ƒä¸€ç¯‡æœ‰è‘—classçš„HTML file.</p>
<figure class="highlight xml"><figcaption><span>Class Sample</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>NCU Target manager<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;background&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;slide-left&quot;</span>&gt;</span>Look up to the sky<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;slide-left&quot;</span>&gt;</span>Gaze at the spectacles<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;slide-left&quot;</span>&gt;</span>Analyze the cosmos<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;slide-left&quot;</span>&gt;</span>Think how it began<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;slide-left&quot;</span>&gt;</span>Welcome to the world of Astronomy<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;start-button&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;tom_home&#x27; %&#125;&quot;</span>&gt;</span>Explore<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>æ•´å€‹æ–‡æª”å¯ä»¥åˆ‡æˆ3éƒ¨åˆ†ï¼šhtml, head, ä»¥åŠbody</li>
<li>html æ¶µæ‹¬æ•´ä»½æª”æ¡ˆçš„é€šå‰‡</li>
<li>headæœƒå„²å­˜æˆ‘å€‘çš„ç°¡ä»‹è³‡è¨Šï¼Œé¡åŒheader</li>
<li>bodyå‰‡æ˜¯æˆ‘å€‘ä¸»æ–‡éƒ¨åˆ†ï¼Œç•¶ä¸­åˆå¯ä»¥åˆ‡æˆsection, div, h1, pç­‰ç­‰å°æ¨™ã€‚</li>
</ol>
<p>æ¥è‘—æˆ‘å€‘å¯ä»¥çœ‹å¦‚ä½•ç”¨style.cssä¾†åšè£é£¾ã€‚</p>
<figure class="highlight css"><figcaption><span>CSS Sample</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">html</span>&#123;</span><br><span class="line">  scroll-behavior: smooth;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#020108</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.background</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="comment">/* display: flex; */</span></span><br><span class="line">  <span class="comment">/* flex-wrap: wrap; */</span></span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">background.jpg</span>);</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-position</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.background</span> <span class="selector-tag">h1</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#d6d6d6</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">font-weight</span>:<span class="number">100</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>*è™Ÿè¡¨ç¤ºä»»ä½•ç‰©ä»¶ï¼Œæˆ‘å€‘è¦æ±‚padding, marginç‚ºï¼ï¼Œé¿å…ç©ºç™½é‚Šç”¢ç”Ÿã€‚</li>
<li>æ¯é …é–‹é ­è¡¨æ˜äº†é‡å°çš„æ¨™ç±¤ç‰©ä»¶ï¼Œç„¶å¾Œä»¥{}å¯«å…¥æ‰€è¦é¢¨æ ¼ã€‚</li>
</ol>
<p>CSSå°±æ˜¯ä½ çš„ç•«ç­†ï¼Œè¦å¦‚ä½•å‰µä½œåœ¨ä¸€å¼µç©ºç™½é é¢ä¸Šé¢ï¼Œå°±è¦é å¤§å®¶çš„æƒ³åƒåŠ›äº†ã€‚<br>å¦‚æœä¸€é–‹å§‹æ²’é ­ç·’å¦‚ä½•å‰µä½œï¼Œåº•ä¸‹æ˜¯ä¸€äº›ç¶²ç«™å¯ä»¥å¸¶çµ¦äººæƒ³åƒç©ºé–“åŠå·¥å…·ã€‚</p>
<ul>
<li>Creations<ul>
<li><a target="_blank" rel="noopener" href="https://www.cssdesignawards.com/">CSS Design Awards</a></li>
<li><a target="_blank" rel="noopener" href="https://www.csswinner.com/">CSS Winner</a></li>
<li><a target="_blank" rel="noopener" href="https://webawards.com/">Web Awards</a></li>
<li><a target="_blank" rel="noopener" href="https://www.webdesign-inspiration.com/">Web Design Inspiration</a></li>
<li><a target="_blank" rel="noopener" href="https://www.awwwards.com/">awwwards</a></li>
<li><a target="_blank" rel="noopener" href="https://thefwa.com/">FWA</a></li>
<li><a target="_blank" rel="noopener" href="https://muuuuu.org/">muuuuu</a></li>
<li><a target="_blank" rel="noopener" href="https://bridgelanding.qodeinteractive.com/">Bridge</a></li>
<li><a target="_blank" rel="noopener" href="https://w-storage.net/?type=corporate-site">w-storage</a></li>
<li><a target="_blank" rel="noopener" href="https://webdesignclip.com/">WebDesignClip</a></li>
<li><a target="_blank" rel="noopener" href="https://responsive-jp.com/">RWDJP</a></li>
<li><a target="_blank" rel="noopener" href="https://io3000.com/">IO</a></li>
<li><a target="_blank" rel="noopener" href="https://html5up.net/">HTML5up free templates</a></li>
</ul>
</li>
<li>CSS animation tools<ul>
<li><a target="_blank" rel="noopener" href="https://animate.style/">Animate.css</a></li>
<li><a target="_blank" rel="noopener" href="https://animista.net/">Animista</a></li>
<li><a target="_blank" rel="noopener" href="https://cssbud.com/">CSS bud</a></li>
<li><a target="_blank" rel="noopener" href="https://ui.glass/generator/">Glassmorphism</a></li>
<li><a target="_blank" rel="noopener" href="https://neumorphism.io/#e0e0e0">Neumorphism.io</a></li>
</ul>
</li>
</ul>
<h3 id="SASS-SCSS"><a href="#SASS-SCSS" class="headerlink" title="SASS/SCSS"></a>SASS/SCSS</h3><p>å¦‚æœä½ é–‹å§‹æœ‰æ¥è§¸åˆ°codepençš„å…§å®¹ï¼Œå¾ˆå¸¸çœ‹åˆ°å¤§å®¶ä¸¦éå¯«å‚³çµ±çš„cssï¼Œè€Œæ˜¯sass/scssï¼Œé‚£é€™å…©å€‹æ±è¥¿æ˜¯ä»€éº¼å‘¢ï¼Ÿ<br>å‰›é–‹å§‹å¯«CSSï¼Œå…¶å¯¦é›£åº¦æ²’æœ‰åˆ°å¾ˆé«˜å› çˆ²å¾ˆè¦–è¦ºåŒ–ï¼Œå¯«ä»€éº¼å¾ˆå¿«å°±æœƒåœ¨ç¶²é ä¸Šçœ‹åˆ°ï¼Œä½†æ˜¯ç•¶ç¶²é å…§å®¹è¶Šä¾†è¶Šè¤‡é›œï¼ŒCSSæœ¬èº«çš„æ¶æ§‹å…¶å¯¦ä¸å®¹æ˜“ç¶­è­·ï¼Œå°¤å…¶æ˜¯åœ¨å…±ç”¨çš„è¨­å®šä»¥åŠç¶²ç‹€çµæ§‹ä¸Šæ²’æœ‰å¤ªå¤šæ”¯æ´æ€§ï¼Œå°è‡´å¸¸å¸¸è¦å¯«å¾ˆå¤§é‡çš„é¸æ“‡å™¨ï¼Œä¹Ÿé–“æ¥å°è‡´ç¶­è­·æ€§é™ä½ä»¥åŠé‡è¤‡æ€§æé«˜ã€‚</p>
<p>SASS/SCSSå°±æ˜¯è™•ç†cssçš„é«˜éšèªè¨€ï¼Œæœ‰è‘—é¡ä¼¼ç¨‹å¼èªè¨€çš„å¯«æ³•ï¼Œå¯ä»¥æå‡ºvariableç­‰æ¦‚å¿µï¼Œå†ç”±è½‰è­¯å™¨è½‰è­¯æˆcssè®“ç¶²é è®€å–</p>
<p>æ¦‚ç•¥ä¸Šä¾†è¬›ï¼Œsassä¸ä½¿ç”¨æ‹¬è™Ÿï¼Œåˆ†è™Ÿï¼Œè€Œscssè¼ƒè²¼è¿‘æ–¼åŸæœ¬csså¯«æ³•ï¼Œä¿æœ‰å¤§æ‹¬è™Ÿä»¥åŠåˆ†è™Ÿï¼Œä½¿ç”¨<code>:</code>ä¾†ä½œç‚ºassignmentç­‰ç­‰ã€‚ç«¯çœ‹ä½ å¸¸ä½¿ç”¨çš„èªè¨€è¼ƒè²¼è¿‘å“ªç¨®å¯«æ³•ï¼Œå†ä¾†é¸æ“‡è¦ä½¿ç”¨sassæˆ–è€…scsså°±å¯ä»¥äº†ã€‚<br><a target="_blank" rel="noopener" href="https://sass-lang.com/guide">Sass Basics</a>å®˜ç¶²ä¸Šæä¾›äº†Sass/Scssçš„ä¸€äº›æ¯”è¼ƒå¯«æ³•ï¼Œæœ‰èˆˆè¶£å¯ä»¥æ·±å…¥ä¸€äº›ã€‚ä½¿ç”¨ä¸Šå¯ä»¥çµ‚ç«¯é–‹è‘—<code>sass --watch input.scss output.css</code>éš¨æ™‚åšcompileã€‚</p>
<hr>
<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><p><img src="/2023/07/03/Django/Moby-logo.png" alt="Official Docker Logo"><span class="image-caption">Official Docker Logo</span></p>
<p>æˆ‘æ˜¯å¤§ç´„ç¢©å£«ç•¢æ¥­å¾Œåœ¨æ‡‰åœ°æ‰€é–‹ç™¼ç¨‹å¼æ¥è§¸åˆ°Dockerï¼Œç•¶æ™‚è¦è™•ç†MDBæª”æ¡ˆï¼Œä½¿ç”¨windowsç³»çµ±ä¸¦ä¸å¥½è™•ç†ï¼Œç„¶è€Œè¦å°‡è»Ÿé«”ç§»æ¤éå»åˆè¦èŠ±è²»å¤ªå¤šç²¾åŠ›ï¼Œæ‰€å¹¸ç™¼ç¾Dockerå¯ä»¥è®“æˆ‘å°‡ä½œæ¥­ç³»çµ±å®¹å™¨åŒ–ï¼Œé”åˆ°é¡ä¼¼è™›æ“¬æ©Ÿçš„æ•ˆæœã€‚</p>
<p>Dockeræ˜¯ä»€éº¼æ™‚å€™é–‹å§‹ç´…çš„å‘¢ï¼ŸDockeræ–¼2013å¹´æ­£å¼ç™¼è¡Œç¬¬ä¸€ç‰ˆæœ¬ï¼Œåˆ°è¿‘5å¹´ä¾†æ‰ç®—æ˜¯çœŸæ­£å´›èµ·ã€‚<br>æœ€å¸¸è¦‹çš„æƒ…æ³æ˜¯åœ¨ä¼ºæœå™¨ç«¯è§£æ±ºå„å€‹ä½¿ç”¨è€…é–‹ç™¼ç’°å¢ƒä¸åŒæ‰€é€ æˆçš„å½±éŸ¿ï¼Œæƒ³åƒAé–‹ç™¼è€…ä½¿ç”¨MacOSæ­é…Python3.6ä»¥åŠDjango3.8æ­é…SQlite3ä¾†åšç¶²é è¦åŠƒï¼Œç„¶è€ŒBé–‹ç™¼è€…ä½¿ç”¨CentOSå®‰è£Python3.9æ­é…Cpythonä»¥åŠPostgreSQLåœ¨åšå¾Œç«¯è™•ç†ï¼Œå…©è€…éµå®šæ‰“æ¶ã€‚</p>
<p>æ­¤æ™‚ä½¿ç”¨DockeræŠŠå„è‡ªç’°å¢ƒåŒ…è£èµ·ä¾†ï¼Œå½¢æˆå…©å€‹ç¨ç«‹ç³»çµ±å°±ä¸æœƒäº’ç›¸å¹²æ“¾ã€‚<br>ç›®å‰ä½¿ç”¨Dockerçš„è‘—åç¶²ç«™æœ‰Adobe, Netlifx, PayPal, Yale, etc.</p>
<p>å¦‚æœä½ æœ‰ç¨‹å¼ç¶“é©—å¯ä»¥åƒè€ƒ<a target="_blank" rel="noopener" href="https://github.com/twtrubiks/docker-tutorial">docker-tutorial</a>ã€‚</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>é€šå¸¸Installationé€™ä¸€éƒ¨åˆ†ä¸æœƒå¤šè¬›ï¼Œä½†Dockerè¦æ³¨æ„çš„æ˜¯ç”±æ–¼å®ƒæ ¸å¿ƒæ¶æ§‹é‚„æ˜¯éœ€è¦Linuxçš„åŸºç¤ï¼Œåœ¨Windowsä¸Šå®‰è£éœ€è¦èµ·ç”¨WSL2æˆ–è€…Hyper-Vï¼Œè€Œä¸”Dockerçš„ç‰ˆæœ¬ä¹Ÿå¯èƒ½æœƒå½±éŸ¿åˆ°å•Ÿå‹•èˆ‡å¦ã€‚<br>åœ¨æˆ‘å€‹äººPCä¸Šæˆ‘å°±é‡åˆ°<code>failed to initialize. Docker is shutting down</code>çš„ç‹€æ³ï¼Œé™åˆ°4.0ç‰ˆæœ¬æ­é…WSL2æ‰æœ‰è¾¦æ³•ä½¿ç”¨ã€‚ç„¶è€Œç¢ºåˆ‡å•é¡Œåœ¨å“ªè£¡æˆ‘ä»ç„¶ä¸æ¸…æ¥šğŸ˜…</p>
<blockquote>
<p>åœ¨Dockerç‰ˆæœ¬ä¸Šï¼Œç›®å‰åœ¨24ç‰ˆé‡åˆ°Arm64æ¶æ§‹æœ‰å•é¡Œâš ï¸ï¼Œéœ€åœ¨buildæ™‚å€™æˆ–è€…åœ¨Docker fileæˆ–è€…Docker-composeè£¡åŠ å…¥<code>--platform linux/amd64</code>ä¾†å®Œæˆ</p>
</blockquote>
<h2 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h2><p>åœ¨Dockerä¸–ç•Œè£¡å¤§è‡´å¯ä»¥åˆ†æˆImagesä»¥åŠContainersï¼ŒImageså°±æ˜¯ä¿—ç¨±æ˜ åƒæª”ï¼Œå¦‚æœä»¥å‰ç©éè™›æ“¬æ©Ÿï¼Œåƒæ˜¯VMware, VirtualBoxç­‰ç­‰ï¼Œæˆ–è€…ä½¿ç”¨DaemonToolä¾†æ›è¼‰è™›æ“¬ç¡¬ç¢Ÿ<del>ç©ç›œç‰ˆéŠæˆ²</del>ï¼Œå¯èƒ½æ¯”è¼ƒæ¸…æ¥šã€‚</p>
<p>æ˜ åƒæª”å°±åƒæ˜¯ä¸€å€‹ä½œæ¥­ç³»çµ±ä¸€æ¨£ï¼Œå¯ä»¥é€éè™›æ“¬æ©Ÿä¾†æ¨¡æ“¬æ˜ åƒæª”ä¸­çš„ä½œæ¥­ç³»çµ±ï¼Œå®›å¦‚æˆ‘å€‘æ‰“é–‹Minecrafté€²åˆ°è£¡é¢ä¸–ç•Œä¸€æ¨£ã€‚<br>å¯ä»¥æƒ³åƒæ˜ åƒæª”å®›å¦‚å¦å¤–ä¸€å°é›»è…¦ï¼Œæœ‰è‘—ä¸åŒçš„ä½œæ¥­ç³»çµ±ä»¥åŠç’°å¢ƒè®Šæ•¸ï¼Œç”šè‡³æ˜¯å„å¼å„æ¨£å·²ç¶“è£å¥½çš„å¥—ä»¶ã€‚</p>
<p>è€Œé€™ä»½æ˜ åƒæª”å¯ä»¥è¢«Dockerå•Ÿç”¨ï¼Œè®ŠæˆContainersï¼Œæ¯å•Ÿç”¨ä¸€æ¬¡å°±åƒå¤šäº†ä¸€çµ„é›»è…¦ä¸€æ¨£ï¼Œç¨ç«‹çš„ç’°å¢ƒï¼Œç¨ç«‹çš„è³‡æ–™ï¼Œä½†æœ‰ç›¸åŒçš„åŸºç¤è¨­å®šã€‚</p>
<p>åœ¨Imageå±¤ç´šï¼Œæˆ‘å€‘å¸¸ç”¨çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>docker images -a -q</code>é¡¯ç¤ºç¾æœ‰æ˜ åƒæª”ï¼Œa: é¡¯ç¤ºå…¨éƒ¨, q:åªé¡¯ç¤ºidã€‚</li>
<li><code>docker rmi [Image name]</code>, remove imagesï¼Œåˆªé™¤æ˜ åƒæª”ã€‚</li>
<li><code>docker rmi $(docker images -a -q)</code>ï¼Œåˆªé™¤æ‰€æœ‰æ˜ åƒæª”ã€‚</li>
<li><code>docker save -o [output file name] [image]</code>ï¼Œè¼¸å‡ºæ˜ åƒå£“ç¸®æª”ã€‚</li>
<li><code>docker load -I [Image file]</code>ï¼Œè®€å–æ˜ åƒå£“ç¸®æª”ã€‚</li>
<li><code>docker history [Image]</code>ï¼ŒæŸ¥è©¢æ˜ åƒæª”æ¡ˆå¯«å…¥æ­·å²ã€‚</li>
</ul>
<h2 id="Containers"><a href="#Containers" class="headerlink" title="Containers"></a>Containers</h2><p>å®¹å™¨Containersç‚ºæˆ‘å€‘å•Ÿç”¨å¾Œæœƒç”¢ç”Ÿçš„ç‰©ä»¶ï¼Œå¯ä»¥æƒ³åƒæ˜¯ä¸€å°ä¸€å°çš„é›»è…¦ï¼Œéš¨é–‹éš¨ç”¨XD<br>æ‰“é–‹å®¹å™¨å¾Œï¼Œæˆ‘å€‘å¯ä»¥é€²åˆ°è£¡é ­çš„command line interfaceï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ç¿’æ…£çš„terminalä¾†é€²è¡Œæ“ä½œã€‚</p>
<p>ä¸éä¸»è¦æˆ‘å€‘æœƒæŠŠæœå‹™å¯«åœ¨Imagesè£¡é ­ï¼Œä¸€æ‰“é–‹å°±æ˜¯å¯ä»¥æº–å‚™ä¸Šç·šçš„ç‹€æ…‹ã€‚</p>
<p>åœ¨Containerå±¤ç´šï¼Œæˆ‘å€‘å¸¸ç”¨çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>dockers ps -a -q</code>ï¼Œé¡¯ç¤ºå®¹å™¨ï¼Œa: é¡¯ç¤ºå…¨éƒ¨, q:åªé¡¯ç¤ºidã€‚</li>
<li><code>docker cp [src file] [containerID:[destination]]</code></li>
<li><code>docker rm [container name]</code>ï¼Œç§»é™¤å®¹å™¨ã€‚</li>
<li><code>docker exec -it [container name] bash</code>ï¼Œåœ¨å®¹å™¨ä¸­æ‰“é–‹bashã€‚<code>exec</code>ç‚ºåŸ·è¡ŒæŒ‡ä»¤ï¼Œå¾Œé¢å¯æ¥æŒ‡ä»¤ä½œç‚ºæ“ä½œã€‚</li>
<li><code>docker logs [container name]</code>ï¼Œè§€çœ‹å®¹å™¨æ—¥èªŒè³‡æ–™ã€‚</li>
<li><code>docker run [IMAGE NAME]</code>ï¼Œé–‹å§‹æ–°çš„å®¹å™¨ï¼Œç•¶ä¸­æœ‰è¨±å¤šoptionsï¼Œåƒè€ƒ<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/run/">docker run</a>ï¼Œ42minsçš„é–±è®€æ™‚é–“ğŸ¤£</li>
<li><code>docker run &lt;image-name&gt; /etc/*release*</code>ï¼ŒæŸ¥çœ‹å®¹å™¨ä½œæ¥­ç³»çµ±ç‰ˆæœ¬ã€‚</li>
<li><code>docker start [container name]</code>ï¼Œé–‹å§‹å®¹å™¨é‹ä½œã€‚</li>
<li><code>docker pause [container name]</code>ï¼Œæš«åœå®¹å™¨é‹ä½œã€‚</li>
<li><code>docker stop [container name]</code>ï¼Œåœæ­¢å®¹å™¨é‹ä½œã€‚</li>
<li><code>docker kill [container name]</code>ï¼Œç§»é™¤å®¹å™¨ã€‚</li>
</ul>
<h2 id="Volumes"><a href="#Volumes" class="headerlink" title="Volumes"></a>Volumes</h2><p>Volumeæˆ‘æƒ³ä¸åˆ°ä¸­è­¯å«ä»€éº¼XDï¼Œå¯ä»¥æƒ³åƒæˆæ˜¯ç¡¬ç¢Ÿçš„æ¦‚å¿µã€‚<br>åœ¨Dockerçš„Containerä»¥åŠé‹è¡Œçš„Host machineé€šå¸¸æ˜¯ä¸å…±ç”¨ç©ºé–“çš„ï¼Œä¹Ÿå°±æ˜¯ç„¡æ³•æŠŠæª”æ¡ˆå…±äº«ä¸¦ä¸”ä¿å­˜ï¼Œæ­¤æ™‚æˆ‘å€‘å°±éœ€è¦æŒ‡å®šVolumeä¾†å­˜æ”¾è³‡æ–™ï¼Œä¸¦ä¸”å¯ä»¥è¢«hostç”šè‡³æ˜¯å…¶ä»–containeræ‰€ä½¿ç”¨ã€‚</p>
<p>åœ¨å¾…æœƒçš„Djangoç•¶ä¸­ï¼Œéœæ…‹æª”æ¡ˆè¦å¦‚ä½•è¢«nginxä»¥åŠweb containerå…±ç”¨å°±æœƒç”¨åˆ°volumeã€‚</p>
<p>é€™é‚ŠVolumeå…ˆä¸å¤šè§£é‡‹ï¼Œæˆ‘æ²’ç”¨å¾ˆå¤šï¼Œå¤§è‡´ä¸Šéƒ½æœƒåœ¨docker-composeå¯«å¥½ã€‚</p>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>èªªäº†é‚£éº¼å¤šå¥½è™•è·ŸåŠŸèƒ½ï¼Œé‚£è¦å¦‚ä½•è£½é€ å‡ºä¸€çš„æˆ‘å€‘æƒ³è¦çš„æ˜ åƒæª”æ¡ˆå‘¢ï¼Ÿé‡é»å°±åœ¨æ–¼æ’°å¯«æˆ‘å€‘çš„Dockerfile.<br>æ²’éŒ¯ï¼Œé€™å€‹Dockerfileæ˜¯æ²’æœ‰å‰¯æª”å(extension)çš„ï¼Œä¸è¦å¿˜è¨˜è‡ªå·±å¤šåŠ å¥‡æ€ªçš„æª”åé€²å»å“¦ğŸ˜†</p>
<p>é—œæ–¼æ’°å¯«ï¼Œå¯ä»¥åƒè€ƒå®˜ç¶²çš„<a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Best practices for writing Dockerfiles</a>ï¼Œä»¥åŠå¯¦ä½œ<a target="_blank" rel="noopener" href="https://docs.docker.com/language/">Language-specific guides</a></p>
<p>æˆ‘å€‘å…ˆåœ¨å®˜ç¶²ç¯„ä¾‹ä¸Šåšèªªæ˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># syntax=docker/dockerfile:1</span><br><span class="line">FROM ubuntu:18.04</span><br><span class="line">COPY . /app</span><br><span class="line">RUN make /app</span><br><span class="line">CMD python /app/app.py</span><br></pre></td></tr></table></figure>
<ol>
<li>FROM: å°å¼•dockerå¾å®˜ç¶²docker imagesè£¡é¢å°å…¥å®˜æ–¹æ˜ åƒæª”æ¡ˆä½œç‚ºåŸºç¤ã€‚</li>
<li>COPY: è¤‡è£½æª”æ¡ˆé€²åˆ°æˆ‘å€‘æ˜ åƒæª”ï¼Œå¾Œé¢æ˜¯æ¥[source] [destinaiton].</li>
<li>RUN: çµ„æˆimageåœ–å±¤ï¼Œå¾Œé¢æ¥çš„æŒ‡ä»¤æœƒåœ¨ç•¶ä¸­çš„çµ‚ç«¯æ©Ÿä¸­åŸ·è¡Œã€‚</li>
<li>CMD: é è¨­å•Ÿå‹•æ™‚çš„æŒ‡ä»¤ã€‚</li>
</ol>
<p>é€™é‚Šè¦æ³¨æ„çš„æ˜¯æ¯ä¸€å€‹RUNéƒ½æœƒæ·»åŠ ä¸€å±¤åœ¨æˆ‘å€‘çš„imageä¸Šé¢ï¼Œæª”æ¡ˆä¹Ÿæœƒå› æ­¤è¶Šä¾†è¶Šå¤§ï¼Œæœ€å¥½æ–¹æ³•æ˜¯RUNå¾Œçš„æŒ‡ä»¤å¯ä»¥ç–ŠåŠ å†ä¸€èµ·å°±ç–ŠåŠ ï¼Œè€ŒCMDåªæœ‰æœ€å¾Œä¸€æ¢æœƒè¢«æ¡ç”¨ã€‚</p>
<hr>
<p>é‚„æœ‰å¸¸ç”¨çš„å°±æ˜¯WORKDIRä»¥åŠENVï¼Œåˆ†åˆ¥è¨­å®šå·¥ä½œç›®éŒ„ç‚ºä½•ï¼Œä»¥åŠç’°å¢ƒè®Šæ•¸ã€‚</p>
<p>ç•¶Dockerfileå¯«å¥½ä¹‹å¾Œï¼Œåœ¨çµ‚ç«¯è¼¸å…¥<code>docker build -t [image name] .</code>å°±æœƒé–‹å§‹çµ„imageæª”æ¡ˆå›‰ã€‚</p>
<h2 id="Docker-example"><a href="#Docker-example" class="headerlink" title="Docker example"></a>Docker example</h2><p>æ¥ä¸‹ä¾†æˆ‘å€‘å¯¦æˆ°ä¸€çµ„Dockerfileï¼Œç¶²è·¯ä¸Šå¤§éƒ¨åˆ†å¯èƒ½æ˜¯node.jsç­‰å°ˆæ¡ˆä¾†å¯¦ä½œï¼Œæˆ‘å€‘é€™é‚Šä»¥æ•¸æ“šè™•ç†ä¾†åšç¯„ä¾‹ï¼Œå‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹å«åšanalyzerçš„å°ˆæ¡ˆï¼Œä¸¦ä¸”åœ¨Python 3.6åº•ä¸‹é‹ä½œã€‚<br>ç›®å‰æª”æ¡ˆæœƒåƒé€™æ¨£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ Dockerfile</span><br><span class="line">â””â”€â”€ analyzer</span><br></pre></td></tr></table></figure>

<p>æˆ‘å€‘ç›®æ¨™æ˜¯æŠŠç’°å¢ƒè™•ç†å¥½ï¼Œä¸¦ä¸€æ‰“é–‹å°±é–‹å•Ÿanalyzeråº•ä¸‹çš„app.pyã€‚</p>
<p>ç¬¬ä¸€æ­¥æ˜¯è¦èª¿ç”¨åŸºåº•åœ–æª”ï¼Œä½ å¯ä»¥å¾ubuntu, CentOSç­‰å¾åŸºåº•é–‹å§‹å®‰è£ï¼Œç•¶ç„¶ä¹Ÿæœ‰æ›´å¿«æ–¹æ³•å°±æ˜¯å¾Pythonåœ–å±¤é–‹å§‹é‹ä½œï¼Œå»ºè­°æ˜¯æ¡ç”¨å¾Œè€…ï¼Œé™ä½æœ€å¾Œçš„æª”æ¡ˆå¤§å°ï¼Œè¦è¨˜ä½æ¯ä¸€å€‹RUNéƒ½æœƒä½¿å¾—æœ€çµ‚imageæª”åŠ å¤§ã€‚</p>
<p>æˆ‘å€‘å¾<a target="_blank" rel="noopener" href="https://hub.docker.com/_/python">Docker hub</a>æ‰¾å°‹æˆ‘å€‘è¦çš„Python image, å¾Œé¢å„ç¨®tagè¡¨ç¤ºé€™å€‹Imageæ§‹æˆæ™‚çš„è©³ç´°ç‹€æ³ï¼Œå»ºè­°é¸ç”¨-slimç‰ˆæœ¬å°±å¯ä»¥ï¼Œæ¸›å°‘ä¸å¿…è¦çš„å¥—ä»¶å®‰è£, e.g., <code>FROM python:3.7-slim</code></p>
<p>æ¥è‘—è¦é¸æ“‡æˆ‘å€‘è¦åŠ åˆ°é€™å€‹imageçš„æª”æ¡ˆä»¥åŠç’°å¢ƒã€‚<br>æˆ‘å€‘è—‰ç”±<code>WORKDIR /app</code>ä¾†æŒ‡å®šæˆ‘å€‘åœ¨appåº•ä¸‹æ“ä½œï¼Œ<code>COPY ./analyzer /app/analyzer/</code>å°‡æˆ‘å€‘åº•ä¸‹çš„analyzerè³‡æ–™å¤¾è¤‡è£½é€²appåº•ä¸‹ã€‚</p>
<p>ç•¶æˆ‘å€‘çš„package/moduleæ‰“åŒ…é€²å»å¾Œï¼Œç›¸é—œçš„dependenciesä»ç„¶é‚„æ²’å®‰è£ï¼Œæˆ‘å€‘æ‡‰ç†Ÿæ‚‰<code>pip freeze &gt; requirements.txt</code>ï¼Œå°‡ç›¸é—œçš„å¥—ä»¶è¨˜éŒ„ä¸‹ä¾†ã€‚<br>æ¥è‘—å¯ä»¥ç”¨<code>RUN pip install -r /app/analyzer/requirements.txt</code>ä¾†å®‰è£æˆ‘å€‘ç´€éŒ„å¥½çš„éœ€æ±‚å¥—ä»¶ã€‚</p>
<p>å‡ä½¿ä½ æ²’æœ‰å…¶ä»–åƒæ•¸æˆ–è€…å¥—ä»¶éœ€è¦å®‰è£ï¼Œé‚£éº¼æœ€å¾Œä¸€æ­¥å°±æ˜¯<code>CMD python /app/analyzer/app.py</code>å•Ÿå‹•ä½ çš„application as the startã€‚<br>é€™æ¨£å°±å®Œæˆä¸€å€‹æœ€ç°¡å–®çš„Dockerfileå›‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.7-slim</span><br><span class="line"></span><br><span class="line">WORKDIR /app</span><br><span class="line"></span><br><span class="line">COPY ./analyzer /app/analyzer/</span><br><span class="line"></span><br><span class="line">RUN /usr/local/bin/python -m pip install --upgrade pip</span><br><span class="line">RUN pip install -r /app/analyzer/requirements.txt</span><br><span class="line">CMD python /app/analyzer/app.py</span><br></pre></td></tr></table></figure>

<hr>
<p>ç•¶ç„¶å¯¦éš›ä¸Šæ“ä½œä¸¦ä¸æ˜¯é€™éº¼å¿«é€Ÿä¸Šæ‰‹ï¼Œä½ å¿…é ˆç¿’æ…£åœ¨Dockerfileè£¡é¢æ‰€ç”¨çš„æ ¼å¼ä»¥åŠè·¯å¾‘ï¼Œæœ‰æ™‚å€™æœƒé‡åˆ°å¯èƒ½å¥—ä»¶è£ä¸ä¸Šå»æˆ–è€…éœ€è¦æ›´æ–°çš„å•é¡Œï¼Œé€™äº›æƒ…æ³æ™‚å¸¸å°è‡´ä½ buildçš„æ¬¡æ•¸å¢åŠ ï¼Œé€²è€Œä½¿å¾—èŠ±åœ¨é€™ä¸Šé¢æ™‚é–“å¢é•·è¨±å¤šã€‚<br>Dockeræ˜¯é–€è—è¡“ï¼Œæœ‰æ™‚å€™å¿…é ˆç´°å¿ƒé ˜æœƒï¼Œæ‰èƒ½é§•è¼•å°±ç†Ÿã€‚ğŸ˜…</p>
<h1 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h1><p>çµ‚æ–¼ä¾†åˆ°æˆ‘å€‘ç†±é–€çš„Djangoæ¡†æ¶ï¼Œåœ¨Pythonèªè¨€è£¡é¢è¦åšç¶²é æ¶æ§‹ï¼Œæœ€å¸¸è¦‹çš„æœ‰streamlit, flaskä»¥åŠDjangoã€‚</p>
<p>Streamlitæ˜¯è£¡é¢æœ€ç°¡ä¾¿çš„æ¶æ§‹ï¼Œå¯ä»¥å¿«é€Ÿå‘ˆç¾ã€éƒ¨ç½²è³‡æ–™ç§‘å­¸æˆæœï¼Œç•¶ä¸­ä¸ä¹ç›´æ¥å‘ˆç¾MLç­‰çµæœï¼Œä½†ç•¶ä¸­ç”¨è¨±å¤šdecoratorçš„æŠ€å·§ï¼Œä¸æ˜“æ›´æ”¹å…¶å…§å®¹ï¼Œå½ˆæ€§ç›¸è¼ƒæ–¼flaskä»¥åŠdjangoè¼ƒç‚ºä½ï¼Œä½†è‹¥æ˜¯è™•ç†è³‡æ–™å‘ˆç¾ï¼Œä¸å¤±ç‚ºä¸€å€‹å¿«é€Ÿçš„æ‰‹æ®µã€‚</p>
<p>Flaskä»¥åŠDjangoéƒ½æ˜¯Pythonä½¿ç”¨è€…å¸¸ç”¨çš„æ¡†æ¶ï¼Œå…©è€…å„æœ‰å„ªç¼ºé»ï¼Œå°æ–¼ç°¡å–®çš„æ‡‰ç”¨ï¼Œä½¿ç”¨Flaskå¯ä»¥é”åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœï¼Œå¾ˆå¿«å¯ä»¥å»ºå‡ºä¸€å€‹åŸå§‹æ¨¡å‹å‡ºä¾†ï¼Œè€ŒDjangoæä¾›æ›´å¥½çš„performanceï¼Œè‹¥æ˜¯å¤§å‹å°ˆæ¡ˆï¼Œæœ‰è³‡å®‰é¡§æ…®ä»¥åŠæ•ˆèƒ½éœ€æ±‚ï¼Œä½¿ç”¨Djangoå®¢è£½åŒ–æœƒæ˜¯è¼ƒå¥½çš„é¸æ“‡ã€‚</p>
<p>ä»¥ä¸Šéƒ½æ˜¯æ·ºè«‡ï¼Œç•¢ç«Ÿæˆ‘åªä½¿ç”¨éstreamlitä»¥åŠdjangoï¼Œå°æ–¼flaskæˆ‘ä¸¦æ²’æœ‰æ·±å…¥ç ”ç©¶ï¼Œæœ‰æ™‚é–“å¯èƒ½åœ¨å°streamlitè€Œå¤–å¯«ä¸€ç¯‡ã€‚</p>
<h2 id="Installation-1"><a href="#Installation-1" class="headerlink" title="Installation"></a>Installation</h2><p>åœ¨ä»»ä½•çš„projectæˆ‘å¼·çƒˆå»ºè­°è¦ä½¿ç”¨ä¸€å€‹æ–°çš„ç’°å¢ƒï¼Œä¸ç®¡ä½ æ˜¯è¦ç”¨<code>virtuallenv -p python3 .</code>æˆ–è€…<code>conda create --name myenv python=3.8</code>ï¼Œç¢ºä¿ä½ çš„ç’°å¢ƒæ˜¯ä¹¾æ·¨çš„ï¼Œé¿å…ç‰ˆæœ¬å•é¡Œå»æ±¡æŸ“ä½ åŸæœ¬çš„ç’°å¢ƒã€‚<br>é€™è£¡å»ºè­°ä½ åƒè€ƒ<a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/4.1/faq/install/">Pythonç‰ˆæœ¬æ”¯æ´</a>ï¼Œä»¥åŠ<a target="_blank" rel="noopener" href="https://www.djangoproject.com/download/">Djangoç‰ˆæœ¬å·®ç•°</a>ä¾†é¸æ“‡é©åˆçš„ç‰ˆæœ¬ä½œç‚ºé–‹ç™¼ç’°å¢ƒã€‚</p>
<p>å®‰è£æ²’ä»€éº¼é›£çš„ï¼Œå°±æ˜¯ä½¿ç”¨pipå®‰è£å³å¯ï¼š<code>python -m pip install Django</code><br>å¦‚æœä½ è¦ä½¿ç”¨çš„Databaseä¸æ˜¯é è¨­çš„SQLiteï¼Œé‚£éº¼å°±æœ‰é¡å¤–çš„å¥—ä»¶éœ€è¦å®‰è£ï¼Œç«¯çœ‹ä½ ä½¿ç”¨å“ªä¸€ç¨®è³‡æ–™åº«ã€‚</p>
<p>å®‰è£å®Œå¯ä»¥<code>python -m django --version</code>ç¢ºèªè‡ªå·±çš„ç‰ˆæœ¬ï¼Œç¶²è·¯ä¸Šå¾ˆå¤šæ•™å­¸å·²ç¶“æ˜¯4ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¾ˆæœ‰å¯èƒ½æœƒè·Ÿä½ ç¾åœ¨ä½¿ç”¨çš„æœ‰æ‰€å‡ºå…¥ã€‚</p>
<h2 id="Start-your-project"><a href="#Start-your-project" class="headerlink" title="Start your project"></a>Start your project</h2><p>ç•¶æˆ‘å€‘ç¢ºèªå®Œå®‰è£å¾Œï¼Œ<code>django-admin startproject mysite</code>å°±å¯ä»¥é–‹å§‹æˆ‘å€‘çš„å°ˆæ¡ˆï¼Œè¼¸å…¥å®Œå¾Œæœƒæœ‰ä¸€ç³»åˆ—è³‡æ–™å¤¾ç”¢ç”Ÿï¼Œé‚£å°±æ˜¯ä½ å°ˆæ¡ˆè£¡é¢çš„æ±è¥¿ã€‚<br>æˆ‘çš„ç‰ˆæœ¬ç‚º4.0.6ï¼Œæ¯å€‹ç‰ˆæœ¬ä¹‹é–“å¯èƒ½æœƒæœ‰æ‰€ä¸åŒã€‚<br>åº•ä¸‹çš„è³‡æ–™çµæ§‹æœƒé•·æˆé€™æ¨£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ mysite</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ manage.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ mysite</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ asgi.py</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ settings.py</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ urls.py</span><br><span class="line">â”‚Â Â      â””â”€â”€ wsgi.py</span><br></pre></td></tr></table></figure>
<p>åœ¨manage.pyé€™å±¤æœƒæ˜¯æˆ‘å€‘ä¸»è¦çš„ä½œæ¥­åœ°æ–¹ï¼Œè©¦è‘—ä½¿ç”¨<code>python manage.py runserver</code>å˜—è©¦å•Ÿå‹•å…§å»ºçš„debugä¼ºæœå™¨ï¼Œæ¥è‘—åœ¨<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/%E6%87%89%E8%A9%B2%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0">http://127.0.0.1:8000/æ‡‰è©²å°±å¯ä»¥çœ‹åˆ°</a><br>é›–ç„¶æœƒè·³å‡ºæˆ‘å€‘æ²’æœ‰åšmigrationç­‰è­¦å‘Šï¼Œä¸éä¸å½±éŸ¿æˆ‘å€‘å•Ÿå‹•ï¼Œä»¥å¾Œä½œæ¥­æœƒé–‹è‘—ä¼ºæœå™¨ï¼Œæ¯æ¬¡å­˜æª”å°±æœƒæ›´æ–°ï¼Œè—‰æ­¤å°ä¼ºæœå™¨åšèª¿æ•´ä»¥åŠdebugã€‚</p>
<p>å¦‚æœä½ è¦æŒ‘é¸å…¶ä»–çš„portä¾†é€£æ¥ï¼Œå¯ä»¥åœ¨<code>runserver</code>å¾Œé¢åŠ ä¸Šä½ è¦ä½¿ç”¨çš„portï¼Œæ¯”å¦‚èªªï¼š<code>python manage.py runserver 8080</code>æˆ–è€…<code>python manage.py runserver 0:8080</code>ä¾†è†è½å…¨éƒ¨çš„portã€‚<br><img src="/2023/07/03/Django/runserver.png" alt="server rocket"><span class="image-caption">server rocket</span></p>
<h2 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h2><p>åœ¨é–‹ç™¼æˆ‘å€‘çš„ç¶²é ä¹‹å‰ï¼Œæˆ‘æƒ³è¦å…ˆè¬›è§£æˆ‘å€‘åº•ä¸‹çš„5å€‹æª”æ¡ˆå„è‡ªçš„åŠŸç”¨ï¼Œåœ¨å¾€å¾Œé–‹ç™¼èª¿ç”¨æ™‚æ‰æ‡‚çš„æµç¨‹ç‚ºä½•ã€‚</p>
<h3 id="manage-py"><a href="#manage-py" class="headerlink" title="manage.py"></a>manage.py</h3><p><code>manage.py</code>å¯ä»¥æƒ³åƒæˆæ˜¯ç›®å‰ç¶²é çš„ä¸»æ§æ ¸å¿ƒï¼Œè£¡é¢æ²’ä»€éº¼éœ€è¦åšä¿®æ”¹ï¼Œä½†å•Ÿå‹•ä¼ºæœå™¨ç­‰ç­‰éƒ½æœƒé€éå®ƒä¾†å‘¼å«ã€‚</p>
<h3 id="asgi-py"><a href="#asgi-py" class="headerlink" title="asgi.py"></a>asgi.py</h3><p>ASGIå¦‚åŒWSGIï¼Œæ˜¯å°æ–¼ç¶²è·¯æœå‹™çš„æ¥å£ï¼Œå®šç¾©ç¶²è·¯ä¸Šçš„è«‹æ±‚è¦å¦‚ä½•èˆ‡Serverç«¯åšè™•ç†ï¼Œæˆ‘å€‘æ¥ä¸‹ä¾†éƒ½æœƒä½¿ç”¨WSGIï¼Œæ‰€ä»¥é€™éƒ¨åˆ†æˆ‘å€‘ä¹Ÿä¸ç”¨è™•ç†ã€‚</p>
<h3 id="settings-py"><a href="#settings-py" class="headerlink" title="settings.py"></a>settings.py</h3><p>åœ¨settings.pyè£¡é ­å°±æœ‰å¾ˆå¤šäº‹æƒ…éœ€è¦æˆ‘å€‘å»å®Œæˆï¼ŒåŸºæœ¬ä¸Šå¤§éƒ¨åˆ†éƒ½æœ‰è¨»è§£å¯«å¥½åœ¨ä¸Šé ­ã€‚<br>å€¼å¾—æˆ‘å€‘æ³¨æ„çš„æ˜¯<code>ALLOWED_HOSTS</code>ä»¥åŠ<code>DEBUG</code>ï¼Œåœ¨é–‹ç™¼æ™‚æœŸæ¸¬è©¦æˆ‘å€‘éƒ½æœƒå°‡DEBUGé–‹å•Ÿï¼Œæ–¹ä¾¿æˆ‘å€‘åµéŒ¯ï¼Œå¦‚éè¦å°‡ç¶²ç«™ä¸Šç·šè¨˜å¾—è¦é—œæ‰ï¼Œé¿å…å‡ºç¾åƒæ˜¯<a target="_blank" rel="noopener" href="https://www.storm.mg/article/35009/2">é€£å‹æ–‡ç«¶é¸ç¶²é é­é§­!?</a>çš„ç³—æ³ã€‚<br>å°‡<code>DEBUG</code>é—œé–‰ä¹‹å¾Œï¼Œç³»çµ±æœƒè¦æ±‚<code>ALLOWED_HOSTS</code>è¨­å®šè¦æ­£ç¢ºï¼Œè‹¥é‚„ä¸ç¢ºå®šè‡ªå·±çš„ç¶²åŸŸï¼Œå…ˆç”¨<code>*</code>æ›¿ä»£ï¼Œä½†æœƒé™ä½å®‰å…¨æ€§ã€‚</p>
<hr>
<p>å…¶ä»–å¾ˆå¸¸å‹•åˆ°çš„è¨­å®šåŒ…æ‹¬<code>TEMPLATES</code>ï¼Œç¨å¾Œæœƒç®¡ç†ä½ çš„éœæ…‹æ¨¡çµ„ç¶²é æª”æ¡ˆï¼Œ<code>DATABASES</code>ç‰½æ¶‰åˆ°å¾€å¾Œä½ çš„è³‡æ–™åº«ç®¡ç†ï¼Œæ˜¯è¦ç”¨Sqliteå‘¢ï¼Ÿé‚„æ˜¯è¦ç”¨Postgresqlå‘¢ï¼Ÿ<br>é‚£ä½ çš„css,js,æˆ–æ˜¯åœ–ç‰‡æª”æ¡ˆè³‡æ–™å¤¾åç¨±æœƒç”±<code>Static</code>ä¾†ç®¡ç†è·¯å¾‘ã€‚ç•¶æˆ‘å€‘é–‹å§‹å‰µå»ºappæ™‚ï¼Œä½ æœƒæ¼¸æ¼¸ç†Ÿæ‚‰é€™äº›åŠŸèƒ½ã€‚</p>
<blockquote>
<p>åœ¨Djangoè£¡é¢ï¼Œæ•´å€‹ç¶²ç«™ç¨±ä½œç‚ºProjectï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ä¸€é–‹å§‹æ‰€ä½¿ç”¨çš„<code>django-admin startproject mysite</code>ï¼Œè€Œappæ‰€æŒ‡çš„æ˜¯ç¶²ç«™å„å€‹åŠŸèƒ½çµ„ä»¶ï¼Œå¯ä»¥æƒ³åƒæ˜¯ä¸€å°è»Šå­ï¼Œè€Œè£¡é¢çš„è¼ªå­ï¼Œæ–¹å‘ç›¤ï¼Œå°èˆªå°±æ˜¯appçš„æ„ç¾©ã€‚</p>
</blockquote>
<h3 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a>urls.py</h3><p><code>url</code>é¡§åæ€ç¾©æœƒç®¡ç†æ‰€æœ‰ç¶²é è·¯å¾‘çš„åç¨±ä»¥åŠå°å‘ï¼Œæœ€å¸¸ä½¿ç”¨çš„æ˜¯<code>path()</code>ä¾†å°è·¯å¾‘ã€‚ä¸»è¦æœƒæœ‰ä¸‰å€‹åƒæ•¸ï¼Œè·¯å¾‘é¡¯ç¤ºåç¨±ï¼Œå…§å®¹ï¼Œä»¥åŠç¨‹å¼å…§ç´¢å¼•åç¨±ã€‚<br>è·¯å¾‘é¡¯ç¤ºåç¨±å³æ˜¯åœ¨ç¶²å€æ¬„æ‰€çœ‹åˆ°çš„ï¼Œé™¤äº†åŸæœ¬ç¶²åŸŸåç¨±å¤–ï¼Œå¾Œå•œå³æ˜¯ç›¸å°è·¯å¾‘ï¼Œå¥½æ¯”èªªinstagram/loginï¼Œä¾†è¡¨ç¤ºç™»å…¥çš„ç¶²é ï¼Œinstagram/storyä¾†è¡¨ç¤ºé™æ™‚å…§å®¹ã€‚<br>è€Œå…§å®¹å¯ä»¥æ˜¯render htmlæ‰€å‡ºä¾†çš„viewï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å¦å¤–ä¸€å€‹<code>urls.py</code>ï¼Œä¾†ç”¢ç”Ÿå­è·¯å¾‘ã€‚<br>ç´¢å¼•åç¨±æ˜¯Djangoå…§éƒ¨æºé€šæ™‚çš„å¿«é€Ÿç®¡é“ï¼Œæˆ‘å€‘å¯ä»¥ä¸ç”¨é€éimportæˆ–è€…è¼¸å…¥çµ•å°è·¯å¾‘ä¾†æ“·å–ç¶²é ï¼Œè€Œé€éé€™åç¨±å¯ä»¥ç›´æ¥è¡¨ç¤ºå‡ºçµ•å°ç¶²å€ã€‚<br><code>path(&#39;login/&#39;, views.login , name=&quot;login_page&quot;)</code></p>
<h2 id="Start-your-Apps"><a href="#Start-your-Apps" class="headerlink" title="Start your Apps"></a>Start your Apps</h2><p>ç¾åœ¨æˆ‘å€‘è£¡é¢é‚„æ²’æœ‰ä»»ä½•åŠŸèƒ½ï¼Œåªæœ‰é è¨­çš„é¦–é ã€‚åœ¨é–‹ç™¼å…¶ä»–åŠŸèƒ½é é¢åŒæ™‚æˆ‘å€‘ä¹Ÿæœƒæ™‚ä¸æ™‚å›åˆ°settings.pyé€²è¡Œåƒæ•¸ä¿®æ”¹ï¼Œè®“æˆ‘å€‘å¾—è¨­å®šå¯ä»¥æ¥æ”¶åˆ°æˆ‘å€‘æ–°çš„é é¢è³‡è¨Šã€‚<br>è¦é–‹å§‹ä¸€å€‹æ–°çš„åŠŸèƒ½æˆ‘å€‘ä½¿ç”¨<code>python manage.py startapp [AppName]</code>ï¼Œé‚£éº¼Djangoå°±æœƒåœ¨åº•ä¸‹ç”Ÿæˆä¸€å€‹<code>AppName</code>çš„è³‡æ–™å¤¾ï¼Œè€Œåº•ä¸‹æœƒæœ‰è¨±å¤šæª”æ¡ˆç­‰è‘—æˆ‘å€‘å»é–‹ç™¼ã€‚</p>
<p>ä½ æœƒç™¼ç¾ä½ çš„Appåº•ä¸‹ä¸¦æ²’æœ‰<code>templates</code>,<code>static</code>,<code>urls.py</code>ï¼Œé€™äº›è¦è‡ªè¡Œå‰µå»ºä¸Šå»ï¼Œç”±æ–¼ä»–å€‘å¾ˆå¸¸ç”¨ï¼Œå»ºè­°æ˜¯å…ˆå‰µå»ºï¼Œå¦‚æœæ²’æœ‰ç”¨åˆ°å†åˆªé™¤ä¹Ÿå¯ä»¥ã€‚<br>æ¥ä¸‹ä¾†æˆ‘å€‘æœƒä¸€å€‹ä¸€å€‹æª”æ¡ˆèµ°éï¼Œæè¿°å¤§è‡´ä¸Šçš„åŠŸç”¨ï¼Œåç©©å›‰ï¼</p>
<figure class="highlight shell"><figcaption><span>App structure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ __init__.py</span><br><span class="line">â”œâ”€â”€ admin.py</span><br><span class="line">â”œâ”€â”€ apps.py</span><br><span class="line">â”œâ”€â”€ migrations</span><br><span class="line">â”œâ”€â”€ models.py</span><br><span class="line">â”œâ”€â”€ templates</span><br><span class="line">â”‚Â Â  â””â”€â”€ repos</span><br><span class="line">â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ static</span><br><span class="line">â”‚Â Â  â””â”€â”€ repos</span><br><span class="line">â”‚Â Â      â””â”€â”€ css</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.css</span><br><span class="line">â”œâ”€â”€ tests.py</span><br><span class="line">â”œâ”€â”€ urls.py</span><br><span class="line">â””â”€â”€ views.py</span><br></pre></td></tr></table></figure>

<h3 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a>views.py</h3><p>ä½œç‚ºç¶²é å°æ–¼ä½¿ç”¨è€…æœ€ç›´æ¥çš„å°±æ˜¯ç•«é¢çš„å‘ˆç¾ï¼Œ<code>views.py</code>é¡§åæ€ç¾©æœƒè™•ç†ç•«é¢çš„æ¸²æŸ“(render)ï¼Œè€Œé€™è£¡çš„æ¸²æŸ“ä¸¦ä¸æŒ‡å–®å–®å°‡å¯«å¥½çš„html,css,jsè¼¸å‡ºè‡³å‰ç«¯ï¼ŒåŒ…æ‹¬å¾Œç«¯è™•ç†è¡¨å–®è³‡æ–™ï¼Œè³‡æ–™åº«è¯ç¹«ä»¥åŠç”¨æˆ¶çš„æ“ä½œå›æ‡‰ç­‰ç­‰ï¼Œéƒ½æœƒåœ¨é€™è£¡å®Œæˆã€‚</p>
<p>æˆ‘å€‘é€™é‚Šåšå¹¾å€‹ä¾‹å­ï¼Œçœ‹å®Œä¾‹å­æ‡‰è©²æœƒå°viewçš„åŠŸèƒ½æ›´ç†Ÿæ‚‰ã€‚å¦‚æœè¦çœ‹è¦‹æˆæœï¼Œå¯ä»¥è·³åˆ°urlçš„éƒ¨åˆ†æ­é…æ“ä½œã€‚</p>
<h4 id="HttpResponse"><a href="#HttpResponse" class="headerlink" title="HttpResponse"></a>HttpResponse</h4><p>æœ€ç‚ºç°¡å–®çš„æ–¹æ³•ç‚ºå›æ‡‰ä¸€å€‹ç°¡å–®çš„httpresponseï¼Œæˆ‘å€‘å¯ä»¥å‰µå»ºä¸€å€‹ç°¡å–®çš„viewä½œç‚ºç¶²é å›æ‡‰ã€‚</p>
<figure class="highlight python"><figcaption><span>views.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">simpleResonse</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&quot;It&#x27;s a simple response.&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="render"><a href="#render" class="headerlink" title="render"></a>render</h4><p><code>render</code>æ˜¯æœ€å¸¸è¦‹çš„æ–¹æ³•ï¼Œè—‰ç”±å‘¼å«å¯«å¥½çš„html,cssç­‰æª”æ¡ˆï¼Œé€é€²åƒæ•¸ï¼Œç›´æ¥è¼¸å‡ºæˆç¶²é å›å‚³åˆ°ä½¿ç”¨è€…ç«¯ã€‚<br>renderæœƒè™•ç†ç¬¬ä¸€å€‹å°±æ˜¯ç”¨æˆ¶ç™¼å‡ºçš„requestï¼Œç¬¬äºŒé …åƒæ•¸æœƒæ”¾å…¥æˆ‘å€‘çš„htmlæª”æ¡ˆï¼Œå®˜æ–¹å»ºè­°æ˜¯æ”¾<code>app/templates/app/index.html</code>ï¼Œé‡è¤‡å…©æ¬¡appåç¨±çš„è³‡æ–™å¤¾ï¼Œä¾†ä½œç‚ºå­˜æ”¾åœ°é»ï¼Œé€™æ¨£å‘¼å«æ™‚å¯ä»¥ä½¿ç”¨åº•ä¸‹çš„æ ¼å¼ï¼Œç¬¬ä¸‰å€‹åƒæ•¸<code>context</code>å‰‡æ˜¯é¸æ“‡æ€§è¼¸å…¥å­—å…¸ï¼Œè¼¸å…¥åƒæ•¸åˆ°æˆ‘å€‘çš„æ¨¡æ¿ä¸­ã€‚</p>
<figure class="highlight python"><figcaption><span>views.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">renderResponse</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;[appName]/index.html&quot;</span>, context)</span><br></pre></td></tr></table></figure>

<h4 id="Handling-form-post"><a href="#Handling-form-post" class="headerlink" title="Handling form post"></a>Handling form post</h4><p>é™¤éæˆ‘å€‘æ˜¯åªç™¼å¸ƒæ¶ˆæ¯ï¼Œå¦å‰‡æˆ‘å€‘ä¸€å®šæœƒè™•ç†åˆ°ä½¿ç”¨è€…ç™¼å‡ºçš„formï¼Œé€™é‚Šæˆ‘å€‘ç¤ºç¯„å¦‚ä½•è™•ç†ä¸€å€‹ä½¿ç”¨è€…ç™¼å‡ºçš„POSTï¼Œä¸¦æŠŠè£¡é¢çš„è³‡æ–™å‚³é”åˆ°è³‡æ–™åº«è£¡é¢ã€‚<br>é€™è£¡çš„<code>NewTargetForm</code>æ˜¯æˆ‘å€‘å¾…æœƒå†<code>forms.py</code>è£¡é¢å®šç¾©çš„ä¸€å€‹classï¼Œå¯ä»¥æƒ³åƒæ˜¯ä¸€å€‹è¡¨å–®ç‰©ä»¶ã€‚</p>
<figure class="highlight python"><figcaption><span>formview.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardform</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="comment"># ç¢ºèªä½¿ç”¨è€…ç™¼å‡ºçš„ç‚ºPOST</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        form = NewTargetForm(request.POST)</span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            Target.objects.create(</span><br><span class="line">                name = form.cleaned_data.get(<span class="string">&#x27;name&#x27;</span>),</span><br><span class="line">                ra = form.cleaned_data.get(<span class="string">&#x27;ra&#x27;</span>),</span><br><span class="line">                dec = form.cleaned_data.get(<span class="string">&#x27;dec&#x27;</span>),</span><br><span class="line">                )</span><br><span class="line">            <span class="keyword">return</span> HttpResponse(<span class="string">&quot;You&#x27;re doing great&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            form = NewTargetForm(&#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br><span class="line">            <span class="keyword">return</span> render(request, <span class="string">&quot;form.html&quot;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        form = NewTargetForm()</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;form.html&quot;</span>, &#123;<span class="string">&#x27;form&#x27;</span>:form&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="urls-py-1"><a href="#urls-py-1" class="headerlink" title="urls.py"></a>urls.py</h3><p>åœ¨urlè£¡é¢æˆ‘å€‘æœƒå‘Šè¨´ç¶²ç«™è¦å¦‚ä½•å‚³å°æˆ‘å€‘çš„ç¶²å€ï¼Œæˆ‘å€‘ä½¿ç”¨<code>path</code>ï¼Œä¾†æ”¾å…¥æˆ‘å€‘è¦é¡¯ç¤ºçš„è·¯å¾‘ï¼Œå°æ‡‰åˆ°çš„viewï¼Œä»¥åŠåœ¨Djangoå…§éƒ¨æˆ‘å€‘å¦‚ä½•å‘¼å«çš„åç¨±ã€‚</p>
<figure class="highlight python"><figcaption><span>urls.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;[appName]&#x27;</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, views.home, name=<span class="string">&#x27;home&#x27;</span>),</span><br><span class="line">    path(<span class="string">&#x27;standardform/&#x27;</span>,views.standardform,name=<span class="string">&quot;standardform&quot;</span>),</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="models-py"><a href="#models-py" class="headerlink" title="models.py"></a>models.py</h3><p>åœ¨æ¯ä¸€å€‹Appåº•ä¸‹ï¼Œä½ å¯ä»¥å‰µå»ºéœ€è¦çš„è³‡æ–™æ¨¡å‹ï¼Œå‡è¨­æ˜¯account appï¼Œä½ å¯ä»¥åœ¨modelsè£¡é¢å‰µç«‹ä¸åŒçš„account modelï¼Œfor instance: å­¸ç”Ÿã€è€å¸«ã€åŠ©ç†ç­‰ç­‰ï¼Œå„è‡ªçš„modelæœ‰ä¸åŒçš„field attributeä»¥åŠæ¬Šé™ç­‰ç­‰ã€‚</p>
<p>æˆ‘å€‘å¯ä»¥çœ‹ä¸€å€‹é—œæ–¼observationçš„ç¯„ä¾‹ï¼Œæ¯ä¸€å€‹attributeç­‰åŒæ–¼é€™å€‹modelåœ¨ä½ çš„è³‡æ–™åº«è£¡é¢çš„column nameï¼Œæ›å¥è©±èªªï¼Œæˆ‘å€‘è³‡æ–™åº«å°±æœƒæœ‰ä¸€å€‹tableå«åšObservationsï¼Œä¸¦ä¸”æœ‰owner, start_dateç­‰ç­‰çš„columnsã€‚</p>
<p>æ¯å€‹fieldåœ¨modelsè£¡é¢å¿…é ˆå…ˆç¢ºç«‹field typesï¼Œåœ¨<a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/4.2/ref/models/fields/">Model field reference</a>å¯ä»¥æ‰¾åˆ°æ”¯æ´çš„fieldé¡å‹ï¼Œä¸è«–æ˜¯date, date time, char,æˆ–è€…æ˜¯booleanç­‰ã€‚</p>
<figure class="highlight python"><figcaption><span>models.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observations</span>(<span class="params">models.Model</span>):</span></span><br><span class="line"></span><br><span class="line">    owner = models.ForeignKey(</span><br><span class="line">        User,on_delete=models.CASCADE,</span><br><span class="line">        null=<span class="literal">False</span>,blank=<span class="literal">False</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    start_date = models.DateTimeField(</span><br><span class="line">    null = <span class="literal">True</span>, blank=<span class="literal">False</span>,</span><br><span class="line">    auto_now_add=<span class="literal">False</span>, verbose_name=<span class="string">&#x27;Start of the observation&#x27;</span>,</span><br><span class="line">    help_text=<span class="string">&#x27;The time when the observation starts&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    end_date = models.DateTimeField(</span><br><span class="line">    null = <span class="literal">True</span>, blank=<span class="literal">False</span>,</span><br><span class="line">    auto_now_add=<span class="literal">False</span>, verbose_name=<span class="string">&#x27;End of the observation&#x27;</span>,</span><br><span class="line">    help_text=<span class="string">&#x27;The time when the observation ends&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    created = models.DateTimeField(</span><br><span class="line">    auto_now_add=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;Time Created&#x27;</span>,</span><br><span class="line">    help_text=<span class="string">&#x27;The time which this campaign was created in the TOM database.&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    modified = models.DateTimeField(</span><br><span class="line">    null=<span class="literal">True</span>, blank=<span class="literal">True</span>,</span><br><span class="line">    auto_now=<span class="literal">True</span>, verbose_name=<span class="string">&#x27;Last Modified&#x27;</span>,</span><br><span class="line">    help_text=<span class="string">&#x27;The time which this campaign was changed in the TOM database.&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    completed_time = models.DateTimeField(</span><br><span class="line">    null=<span class="literal">True</span>, blank=<span class="literal">True</span>,</span><br><span class="line">    auto_now=<span class="literal">False</span>, verbose_name=<span class="string">&#x27;Time completed&#x27;</span>,</span><br><span class="line">    help_text=<span class="string">&#x27;The time which this campaign was finished in the TOM database.&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    campaign = models.ForeignKey(to = Campaign , on_delete=models.CASCADE ,related_name=<span class="string">&quot;observations&quot;</span>, null = <span class="literal">False</span>, blank=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    target = models.ForeignKey(to = Target, on_delete=models.CASCADE ,related_name=<span class="string">&quot;observations&quot;</span>, null=<span class="literal">False</span>,blank=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    comments = models.CharField(</span><br><span class="line">        max_length=<span class="number">150</span>, default=<span class="string">&quot;&quot;</span>, unique=<span class="literal">False</span>,null=<span class="literal">True</span>,blank=<span class="literal">True</span>,verbose_name=<span class="string">&quot;Description of the campaign&quot;</span>,</span><br><span class="line">        help_text=<span class="string">&quot;Write down descriptions of this campaign to remind yourself or the PI&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    airmass = models.FloatField(</span><br><span class="line">        null=<span class="literal">True</span>, blank=<span class="literal">True</span>,</span><br><span class="line">        verbose_name=<span class="string">&#x27;Max airmass&#x27;</span>, help_text=<span class="string">&#x27;Maximum airmass&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    exposure = models.FloatField(</span><br><span class="line">        null=<span class="literal">True</span>, blank=<span class="literal">True</span>,</span><br><span class="line">        verbose_name=<span class="string">&#x27;Exposure time&#x27;</span>, help_text=<span class="string">&#x27;Exposure time&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bin</span> = models.IntegerField(</span><br><span class="line">        null=<span class="literal">True</span>, blank=<span class="literal">True</span>, default=<span class="number">1</span>,</span><br><span class="line">        verbose_name=<span class="string">&#x27;Bin number&#x27;</span>, help_text=<span class="string">&#x27;merge pixel array, 2 mean 2x2 merger&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    frame = models.IntegerField(</span><br><span class="line">        null=<span class="literal">False</span>, blank=<span class="literal">False</span>, default=<span class="number">1</span>,</span><br><span class="line">        verbose_name=<span class="string">&#x27;Number of frames&#x27;</span>, help_text=<span class="string">&#x27;Number of frames is requested&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    priority = models.CharField(</span><br><span class="line">    max_length=<span class="number">5</span>,</span><br><span class="line">    null=<span class="literal">False</span>, blank=<span class="literal">False</span>,</span><br><span class="line">    choices= [</span><br><span class="line">        (<span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;Target of opportunity&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;High&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;Medium&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;Low&#x27;</span>),</span><br><span class="line">        (<span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;None&#x27;</span>)</span><br><span class="line">    ],</span><br><span class="line">    verbose_name=<span class="string">&#x27;Priority&#x27;</span>, help_text=<span class="string">&#x27;Observation priority.&#x27;</span>,</span><br><span class="line">    default=<span class="string">&#x27;N&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h1><p>éƒ¨ç½²ç’°ç¯€ä¸»è¦åƒè€ƒåº•ä¸‹æ–‡ç« <a target="_blank" rel="noopener" href="https://testdriven.io/blog/dockerizing-django-with-postgres-gunicorn-and-nginx/">Dockerizing Django with Postgres, Gunicorn, and Nginx</a>, <a target="_blank" rel="noopener" href="https://github.com/uranusjr/django-tutorial-for-programmers/blob/1.8/25-deploy-to-ubuntu-server.md">django-tutorial-for-programmers</a>ã€‚<br>å‰ç¯‡æ–‡ç« å¤§è‡´ä¸Šç¶²è·¯ä¸ŠæŠ„ä¾†æŠ„å»ï¼Œä¾†æºä¸å¯è€ƒï¼Œå¾Œç¯‡æ–‡ç« æœ‰é»éæ™‚ï¼Œè£¡é¢çš„æœ‰äº›æ–¹æ³•å·²ç¶“deprecatedï¼Œä¸éæƒ³è¦äº†è§£å¤§éƒ¨åˆ†æµç¨‹å¾ˆæ¨è–¦ç¬¬äºŒç¯‡æ–‡ç« ã€‚</p>
<h2 id="Django-setup"><a href="#Django-setup" class="headerlink" title="Django setup"></a>Django setup</h2><p><code>django-admin startproject deployment</code> å‰µå»ºæˆ‘å€‘çš„å°ˆæ¡ˆè³‡æ–™å¤¾ã€‚<br>é€²å…¥è³‡æ–™å¤¾å¾Œï¼Œæˆ‘å€‘å…ˆ<code>python manage.py runserver</code>ä¾†çœ‹çœ‹æ˜¯å¦æˆåŠŸã€‚æ­£å¸¸æ‡‰è©²æœƒé¡¯ç¤ºä»¥ä¸‹ç•«é¢ä¸¦ä¸”è³‡æ–™å¤¾å¤šäº†ä¸€å€‹db.sqlite3æª”æ¡ˆã€‚</p>
<p><img src="/2023/07/03/Django/runserver.png" alt="ä¼ºæœå™¨å•Ÿå‹•é é¢"><span class="image-caption">ä¼ºæœå™¨å•Ÿå‹•é é¢</span></p>
<p>ç›®å‰çš„æª”æ¡ˆæ‡‰è©²æœƒé•·å¾—åƒé€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ db.sqlite3</span><br><span class="line">â”œâ”€â”€ deployment</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ asgi.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ settings.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ urls.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ wsgi.py</span><br><span class="line">â””â”€â”€ manage.py</span><br></pre></td></tr></table></figure>

<h2 id="Docker-file"><a href="#Docker-file" class="headerlink" title="Docker file"></a>Docker file</h2><p>æ¥é€™æˆ‘å€‘è¦æ’°å¯«Dockerfileä¾†æ‰“åŒ…æˆ‘å€‘çš„Deploymentã€‚<br>é€™é‚Šå¾ˆå¤šäººæœƒç”¨alphineçš„ç‰ˆæœ¬ä¾†ç¸®æ¸›æœ€çµ‚æª”æ¡ˆå¤§å°ï¼Œä½†ä½ å¦‚æœæœå°‹alpineæœƒå‡ºç¾2020ä¸€å †äººä¸æ¨è–¦ä½¿ç”¨ï¼ŒåŸå› å‡ºåœ¨åœ¨å®‰è£å¾ˆå¤šè»Ÿé«”æ™‚ï¼ŒAlpine Linux Projectéœ€è¦ç‰¹åˆ¥èª¿æ•™æ‰å¯ä»¥å®‰è£ï¼Œé€™åœ¨é™¤éŒ¯éç¨‹æœƒèŠ±ä½ å¾ˆå¤šæ™‚é–“ï¼Œé€™é‚Šæˆ‘å»ºè­°ä½¿ç”¨slimç‰ˆæœ¬å°±å¯ä»¥ï¼Œé€™æœƒä½¿dockerizeéç¨‹å¥½å¾ˆå¤šã€‚</p>
<figure class="highlight dockerfile"><figcaption><span>Dockerfile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.9</span>-slim</span><br><span class="line"></span><br><span class="line"><span class="comment"># set work directory</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># copy project</span></span><br><span class="line"><span class="comment"># é€™é‚Šæœƒå°‡Dockerfileæ‰€åœ¨ä½ç½®çš„æª”æ¡ˆå…¨éƒ¨è¤‡è£½ä¸€ä»½åˆ°/appåº•ä¸‹ï¼Œæ³¨æ„å¦‚æœè¦è¤‡è£½è³‡æ–™å¤¾è¦ç”¨COPY ./deployment  /app/deployment/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set environment variables</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Prevents Python from writing pyc files to disc (equivalent to python -B option)</span></span><br><span class="line"><span class="keyword">ENV</span> PYTHONDONTWRITEBYTECODE <span class="number">1</span></span><br><span class="line"><span class="comment"># Prevents Python from buffering stdout and stderr (equivalent to python -u option)</span></span><br><span class="line"><span class="keyword">ENV</span> PYTHONUNBUFFERED <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install --upgrade pip</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install -r requirements.txt</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker-compose"></a>Docker-compose</h2><p>å¯«å¥½dockerfileä¹‹å¾Œæˆ‘å€‘è¦å¯«ä¸€å€‹docker-compose.ymlï¼Œdocker-composeçš„ä¸»è¦ç›®çš„åœ¨æˆ‘å€‘å¯ä»¥æŠŠå…ƒä»¶åˆ†é–‹ï¼Œæƒ³åƒæˆ‘å€‘è¦æœ‰ç¶²é ä¹Ÿè¦æœ‰è³‡æ–™åº«ï¼Œæˆ‘å€‘å¯ä»¥è—‰ç”±docker-composeä¾†åˆ†åˆ¥ç®¡ç†å„è‡ªçš„containerã€‚</p>
<blockquote>
<p>The Compose file is a YAML file defining services, networks, and volumes for a Docker application. For (more information)[<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/compose-file/]">https://docs.docker.com/compose/compose-file/]</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Deprecated. only informative now.</span><br><span class="line">version: &#x27;3.8&#x27;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    # build should point to a directory containing the Dockerfile</span><br><span class="line">    build: ./</span><br><span class="line">    command: python manage.py runserver 0.0.0.0:8000</span><br><span class="line">    volumes:</span><br><span class="line">      - ./app/:/usr/src/app/</span><br><span class="line">    ports:</span><br><span class="line">      - 8000:8000</span><br></pre></td></tr></table></figure>

<hr>
<p>è‡³æ­¤èˆ‡åŸå…ˆrunserverå…¶å¯¦æ²’ä»€éº¼ä¸ä¸€æ¨£ï¼Œåªæ˜¯å°å…¥docker-composeä¾†åŸ·è¡Œè€Œå·²ï¼Œè€Œè£¡é¢ä¹Ÿåªæœ‰åŸ·è¡Œweb serviceã€‚<br>æ¥ä¸‹ä¾†æˆ‘å€‘æœƒå°‡è³‡æ–™åº«Postgreså°å…¥ï¼Œç›®å‰æª”æ¡ˆçœ‹èµ·ä¾†æ‡‰è©²æœƒåƒé€™æ¨£ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ db.sqlite3</span><br><span class="line">â”œâ”€â”€ deployment</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ asgi.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ settings.py</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ urls.py</span><br><span class="line">â”‚Â Â  â””â”€â”€ wsgi.py</span><br><span class="line">â”œâ”€â”€ docker-compose.yml</span><br><span class="line">â””â”€â”€ manage.py</span><br></pre></td></tr></table></figure>

<p>é€™é‚Šå¯ä»¥è©¦è·‘<code>docker-compose build</code>å»ºç«‹æˆ‘å€‘çš„imagesï¼Œæ¥é€™ç”¨<code>docker-compose up -d</code>ä¾†çœ‹æ˜¯å¦æˆåŠŸã€‚æˆåŠŸçš„è©±æ‡‰è©²æœƒé¡¯ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Creating network &quot;deployment_default&quot; with the default driver</span><br><span class="line">Creating deployment_web_1 ... done</span><br></pre></td></tr></table></figure>
<p>åœ¨ç€è¦½å™¨è¼¸å…¥<code>http://localhost:8000</code>æ‡‰è©²å¯ä»¥å¾—åˆ°å¦‚ä¸€é–‹å§‹çš„ç•«é¢ã€‚</p>
<h2 id="Postgres-service"><a href="#Postgres-service" class="headerlink" title="Postgres service"></a>Postgres service</h2><h3 id="docker-compose-services"><a href="#docker-compose-services" class="headerlink" title="docker-compose services"></a>docker-compose services</h3><p>ç­‰ä¸‹è¦è¼¸å…¥çš„åƒæ•¸å¯ä»¥åƒè€ƒ<a target="_blank" rel="noopener" href="https://hub.docker.com/_/postgres">postgres DOCKER OFFICIAL IMAGE</a>ã€‚</p>
<blockquote>
<p>Postgresè£¡ï¼Œé™¤äº†<code>POSTGRES_PASSWORD </code>ä»¥å¤–éƒ½æ˜¯optionalã€‚</p>
</blockquote>
<p>æˆ‘å€‘è¦æŠŠPostgresåŠ å…¥åˆ°æˆ‘å€‘çš„serviceè£¡é ­ï¼Œæ‰€ä»¥æˆ‘å€‘è¦å°å‰›å¯«å¥½çš„docker-compose.ymlé€²è¡Œä¿®æ”¹ã€‚<br>é€™è£¡é¢çš„volumeæœƒæŒ‡å‡ºå¯ä»¥è¢«ä¸åŒcontainerå…±äº«çš„ä½å€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># Deprecated. only informative now.</span><br><span class="line">version: &#x27;3.8&#x27;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    # build should point to a directory containing the Dockerfile</span><br><span class="line">    build: ./</span><br><span class="line">    command: python manage.py runserver 0.0.0.0:8000</span><br><span class="line">    volumes:</span><br><span class="line">      - ./app/:/usr/src/app/</span><br><span class="line">    ports:</span><br><span class="line">      - 8000:8000</span><br><span class="line">  db:</span><br><span class="line">    image: postgres:14</span><br><span class="line">    volumes:</span><br><span class="line">      - postgres_data:/var/lib/postgresql/data/</span><br><span class="line">    environment:</span><br><span class="line">      - POSTGRES_USER=Tyler</span><br><span class="line">      - POSTGRES_PASSWORD=password</span><br><span class="line">      - POSTGRES_DB=deploy_test_db</span><br><span class="line"></span><br><span class="line">volumes:</span><br><span class="line">  postgres_data:</span><br></pre></td></tr></table></figure>

<h3 id="settings-py-1"><a href="#settings-py-1" class="headerlink" title="settings.py"></a>settings.py</h3><p>ç¾åœ¨æˆ‘å€‘è¦æ›´æ–°æˆ‘å€‘åŸæœ¬ä½¿ç”¨çš„databaseè¨­å®šï¼Œå°‡/deployment/settings.pyåº•ä¸‹çš„DATABASESåšä¸€ä¸‹æ›´æ”¹ã€‚<br>é€™é‚Šæˆ‘å€‘é–‹å§‹å°‡åƒæ•¸è¼¸å…¥è‡³ç’°å¢ƒè®Šæ•¸ä¸­ï¼Œè€Œä¸ç›´æ¥å­˜æ”¾åœ¨codeè£¡é¢ï¼Œå†è—‰ç”±os.environ.getå»å­˜å–ç’°å¢ƒè®Šæ•¸ï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯å­˜å–ä¸åˆ°æ™‚çš„é è¨­å€¼ã€‚<br>é€™è£¡è¨˜å¾—è¦<code>import os</code>åœ¨æœ€å‰é¢ã€‚))åƒæˆ‘å°±å¿˜è¨˜ï¼Œdockerizeä¹‹å¾Œæ‰åˆè¦é‡è·‘ğŸ˜</p>
<figure class="highlight python"><figcaption><span>Settings.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Before</span></span><br><span class="line"></span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: BASE_DIR / <span class="string">&#x27;db.sqlite3&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># After</span></span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&quot;default&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;ENGINE&quot;</span>: os.environ.get(<span class="string">&quot;SQL_ENGINE&quot;</span>, <span class="string">&quot;django.db.backends.sqlite3&quot;</span>),</span><br><span class="line">        <span class="string">&quot;NAME&quot;</span>: os.environ.get(<span class="string">&quot;SQL_DATABASE&quot;</span>, BASE_DIR / <span class="string">&quot;db.sqlite3&quot;</span>),</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: os.environ.get(<span class="string">&quot;SQL_USER&quot;</span>, <span class="string">&quot;user&quot;</span>),</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: os.environ.get(<span class="string">&quot;SQL_PASSWORD&quot;</span>, <span class="string">&quot;password&quot;</span>),</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: os.environ.get(<span class="string">&quot;SQL_HOST&quot;</span>, <span class="string">&quot;localhost&quot;</span>),</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: os.environ.get(<span class="string">&quot;SQL_PORT&quot;</span>, <span class="string">&quot;5432&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Update-Dockerfile"><a href="#Update-Dockerfile" class="headerlink" title="Update Dockerfile"></a>Update Dockerfile</h3><p>é€™é‚Šæˆ‘å€‘å°‡å¾ˆå¤šæ±è¥¿å­˜é€²ç’°å¢ƒè®Šæ•¸è£¡ï¼Œä½†æˆ‘å€‘å¯ä¸æƒ³è¦æ¯æ¬¡éƒ½è¦exporté€™äº›è®Šæ•¸ï¼Œåœ¨Dockerfileè£¡é¢æˆ‘å€‘å¯ä»¥è—‰ç”±<code>ENV</code>å»è¨­å®šç’°å¢ƒè®Šæ•¸ã€‚</p>
<figure class="highlight docker"><figcaption><span>Docker ENVs</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># set environment variables</span></span><br><span class="line"><span class="keyword">ENV</span> SQL_ENGINE=django.db.backends.postgresql</span><br><span class="line"><span class="keyword">ENV</span> SQL_DATABASE=deployment_db</span><br><span class="line"><span class="keyword">ENV</span> SQL_USER=tyler</span><br><span class="line"><span class="keyword">ENV</span> SQL_PASSWORD=password</span><br><span class="line"><span class="keyword">ENV</span> SQL_HOST=db</span><br><span class="line"><span class="keyword">ENV</span> SQL_PORT=<span class="number">5432</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ¥è‘—å°‡pythonèˆ‡postgresqlæºé€šçš„å¥—ä»¶:<code>psycopg2-binary==2.9.1</code>çµ¦åŠ å…¥æˆ‘å€‘<code>requirements.txt</code>ä¸­ã€‚<br>ä¸¦ä¸”å®‰è£ç›¸é—œçš„dependencies.</p>
<figure class="highlight docker"><figcaption><span>install dependencies</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># install psycopg2 dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get -y update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get -y upgrade</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install postgresql postgresql-contrib libpq-dev nginx supervisor vim -y</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>æˆ‘å€‘æ¥è‘—è©¦è‘—è·‘è·‘çœ‹<code>docker-compose build</code>ä¸¦ä¸”å°‡å®ƒ<code>builder-compose up -d</code>çœ‹çœ‹æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚<br>æ­¤æ™‚é€²åˆ°localhost:8000æ‡‰è©²ä¾ç„¶æœƒçœ‹åˆ°ç«ç®­å‡ç©ºçš„ç•«é¢ã€‚</p>
<h3 id="Django-Migrate"><a href="#Django-Migrate" class="headerlink" title="Django Migrate"></a>Django Migrate</h3><p>æˆ‘å€‘æ­¤æ™‚å…ˆä¸å°‡<code>docker-compose down -v</code>ï¼Œæˆ‘å€‘è¼¸å…¥<code>docker-compose exec web python manage.py migrate --noinput</code>ä¾†å°‡æˆ‘å€‘æ–°çš„è¨­å®šåšmigrations.</p>
<p>ä¾ç„¶å…ˆä¸åšdownçš„å‹•ä½œï¼Œæˆ‘å€‘<code>docker-compose exec db psql --username=tyler --dbname=deployment_db</code>ä¾†æ¸¬è©¦æ˜¯å¦å¯ä»¥é€²å…¥postgresqlçš„databaseè£¡é ­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">docker-compose exec db psql --username=tyler --dbname=deployment_db</span><br><span class="line">psql (14.5 (Debian 14.5-1.pgdg110+1))</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">deployment_db=# \l</span><br><span class="line">                               List of databases</span><br><span class="line">     Name      | Owner | Encoding |  Collate   |   Ctype    | Access privileges</span><br><span class="line">---------------+-------+----------+------------+------------+-------------------</span><br><span class="line"> deployment_db | tyler | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> postgres      | tyler | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> template0     | tyler | UTF8     | en_US.utf8 | en_US.utf8 | =c/tyler         +</span><br><span class="line">               |       |          |            |            | tyler=CTc/tyler</span><br><span class="line"> template1     | tyler | UTF8     | en_US.utf8 | en_US.utf8 | =c/tyler         +</span><br><span class="line">               |       |          |            |            | tyler=CTc/tyler</span><br><span class="line">(4 rows)</span><br><span class="line"></span><br><span class="line">deployment_db=# \c deployment_db</span><br><span class="line">You are now connected to database &quot;deployment_db&quot; as user &quot;tyler&quot;.</span><br><span class="line">deployment_db=# \dt</span><br><span class="line">                  List of relations</span><br><span class="line"> Schema |            Name            | Type  | Owner</span><br><span class="line">--------+----------------------------+-------+-------</span><br><span class="line"> public | auth_group                 | table | tyler</span><br><span class="line"> public | auth_group_permissions     | table | tyler</span><br><span class="line"> public | auth_permission            | table | tyler</span><br><span class="line"> public | auth_user                  | table | tyler</span><br><span class="line"> public | auth_user_groups           | table | tyler</span><br><span class="line"> public | auth_user_user_permissions | table | tyler</span><br><span class="line"> public | django_admin_log           | table | tyler</span><br><span class="line"> public | django_content_type        | table | tyler</span><br><span class="line"> public | django_migrations          | table | tyler</span><br><span class="line"> public | django_session             | table | tyler</span><br><span class="line">(10 rows)</span><br><span class="line"></span><br><span class="line">deployment_db=# \q</span><br></pre></td></tr></table></figure>

<p>åˆ°é€™é‚Šæ‡‰è©²æ˜¯æ²’å•é¡Œäº†ï¼Œä½†æˆ‘å€‘ä»ç„¶åœ¨è—‰ç”±Dockerä¾†ç¢ºèªä¸€éã€‚<br><code>docker volume ls</code>ä¾†çœ‹æˆ‘å€‘ç¾æœ‰çš„volumeæœ‰å“ªäº›ï¼Œé€™è£¡æ‡‰è©²æœƒçœ‹åˆ°<code>local     deployment_postgres_data</code>ã€‚<br>æˆ‘å€‘ç”¨inspectä¾†çœ‹è£¡é ­è³‡è¨Š<code>docker volume inspect deployment_postgres_data</code>ï¼Œå¦‚æœæœ‰è·‘å‡ºç›¸é—œå…§å®¹ï¼Œé‚£å°±ä»£è¡¨æˆ‘å€‘æˆåŠŸå°‡postgresqlè£é€²æˆ‘å€‘Djangoè£¡é¢äº†ã€‚</p>
<h3 id="Flow-control"><a href="#Flow-control" class="headerlink" title="Flow control"></a>Flow control</h3><p>åœ¨docker-compose.ymlæª”æ¡ˆè£¡é ­é›–ç„¶depends on dbï¼Œä½†å¯¦éš›åŸ·è¡Œæ™‚ä¸¦ä¸æœƒç­‰dbå•Ÿå‹•æ¥è‘—å•Ÿå‹•webï¼Œæ˜¯æœ‰å¯èƒ½ç™¼ç”Ÿwebå•Ÿå‹•äº†ä½†dbé‚„æ²’å•Ÿå‹•ï¼Œé€ æˆè³‡æ–™åº«é€£ä¸ä¸Šçš„æƒ…æ³ã€‚<br>åœ¨<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/startup-order/">Control startup and shutdown order in Compose</a>è£¡é ­æœ‰è©³ç´°èªªæ˜ï¼Œä¸»è¦æ˜¯containerçš„å•Ÿå‹•ï¼Œè€Œä¸æ˜¯åµæ¸¬å®¹å™¨çš„readyï¼Œæ‰æœƒé€ æˆé€™ç¨®ç¾è±¡ã€‚</p>
<p>è§£æ±ºæ–¹æ³•å°±æ˜¯æˆ‘å€‘è‡ªå·±å¯«ä¸€å€‹bash scriptä¾†è™•ç†</p>
<h2 id="Gunicorn"><a href="#Gunicorn" class="headerlink" title="Gunicorn"></a>Gunicorn</h2><p>åˆ°ç›®å‰ç‚ºæ­¢æˆ‘å€‘éƒ½é‚„åœ¨ç”¨runserverä¾†å•Ÿå‹•ä¼ºæœå™¨ï¼Œä½†æ˜¯è‡ªå¸¶çš„ä¼ºæœå™¨ä¸¦ä¸é©åˆä¾†å°å¤–ï¼Œåªé©åˆåšç‚ºé–‹ç™¼æ™‚ä½¿ç”¨ï¼Œç•¢ç«Ÿæˆ‘å€‘éœ€è¦æ›´å¤šåŠŸèƒ½ä¸”è³‡å®‰ä¸Šè¦æ›´å®‰å…¨çš„æ¥å£ã€‚</p>
<h3 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h3><p>æˆ‘å€‘å°‡web serviceåº•ä¸‹çš„<code>python manage.py runserver 0.0.0.0:8000</code>æ›¿æ›æˆ<code>gunicorn deployment.wsgi:application --bind 0.0.0.0:8000</code>ã€‚</p>
<blockquote>
<p>åœ¨é‡æ–°å°‡ä¼ºæœå™¨ä¸Šç·šæ™‚ï¼Œæˆ‘é‡åˆ°<code>gunicorn: command not found</code>ä»¥åŠ<code>wsgi: No module named &#39;settings&#39;</code>ï¼Œåœ¨requirements.txtè£¡é¢ç¢ºèªæœ‰<code>gunicorn==20.1.0</code>ï¼Œè€Œéåœ¨Dockerfileè£¡é¢<code>RUN apt-get install gunicorn -y</code>è£¡é¢ï¼Œæˆ‘å€‘å•Ÿç”¨çš„æœå‹™æ˜¯pythonè£¡é¢çš„gunicornè€Œéå¾apt-getå®‰è£çš„ï¼Œè‹¥å‘¼å«éŒ¯æœƒå°è‡´pythonè£¡é¢çš„moduleè®€ä¸åˆ°ã€‚</p>
</blockquote>
<hr>
<h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>æ¥ä¸‹ä¾†æˆ‘å€‘è¦å°‡nginxåŠ å…¥è‡³æˆ‘å€‘çš„djangoç•¶ä¸­ï¼Œä»–æœƒæ‰®æ¼”ä¸€å€‹è™•ç†requestsçš„æ©‹æ¨‘ã€‚</p>
<h3 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h3><p>æˆ‘å€‘å°‡é€™å€‹serviceåŠ å…¥åˆ°æˆ‘å€‘çš„composeï¼Œä¸¦å°‡web serviceçš„portsæ›´æ”¹ç‚ºexpose.</p>
<figure class="highlight docker"><figcaption><span>DockerCompose</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">web:</span><br><span class="line">  <span class="comment"># build should point to a directory containing the Dockerfile</span></span><br><span class="line">  build: ./</span><br><span class="line">  command: gunicorn deployment.wsgi:application --bind <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8000</span></span><br><span class="line">  volumes:</span><br><span class="line">    - ./app/:/usr/src/app/</span><br><span class="line">  <span class="keyword">expose</span>:</span><br><span class="line">    - <span class="number">8000</span></span><br><span class="line">  depends_on:</span><br><span class="line">    - db</span><br></pre></td></tr></table></figure>

<figure class="highlight nginxconf"><figcaption><span>Nginx conf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nginx:</span><br><span class="line">  build: ./<span class="attribute">nginx</span></span><br><span class="line">  ports:</span><br><span class="line">    - <span class="number">1337</span>:<span class="number">80</span></span><br><span class="line">  depends_on:</span><br><span class="line">    - web</span><br></pre></td></tr></table></figure>

<h3 id="conf-files"><a href="#conf-files" class="headerlink" title="conf files"></a>conf files</h3><p>ç•¶æˆ‘å€‘åŠ é€²nginxå»æ²’æœ‰è¨­å®šæª”æ€éº¼è¡Œå‘¢ï¼Œæˆ‘å€‘åœ¨åº•ä¸‹å»ºç«‹ä¸€å€‹nginxè³‡æ–™å¤¾ï¼Œä¸¦åœ¨è£¡é ­æ–°å¢Dockerfileä»¥åŠnginx.conf</p>
<h4 id="Dockerfile-1"><a href="#Dockerfile-1" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><figure class="highlight docker"><figcaption><span>Docker Nginx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> nginx:<span class="number">1.23</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> rm /etc/nginx/conf.d/default.conf</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> nginx.conf /etc/nginx/conf.d</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a>nginx.conf</h4><figure class="highlight nginxconf"><figcaption><span>Nginx conf</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> deployment &#123;</span><br><span class="line">    <span class="attribute">server</span> web:<span class="number">8000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://deployment;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host $host;</span><br><span class="line">        <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>åˆ°é€™é‚Šæˆ‘å€‘åœ¨è©¦è‘—å•Ÿå‹•çœ‹çœ‹ï¼Œ<code>docker-compose up -d --build</code>å°‡å…©å€‹ç’°ç¯€åˆä½µå†ä¸€èµ·ï¼Œæ­¤æ™‚è¼¸å…¥localhost:1337å°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘çš„ç«ç®­å‡ç©ºå›‰ã€‚</p>
<h2 id="Get-online"><a href="#Get-online" class="headerlink" title="Get online"></a>Get online</h2><p>åˆ°ç›®å‰ç‚ºæ­¢æˆ‘å€‘ä½¿ç”¨äº†postgresql, gunicorn, ä»¥åŠnginxä¾†è·‘æˆ‘å€‘çš„ä¼ºæœå™¨ï¼Œä½†å¦‚æœé€™æ™‚å€™å»è·‘å…§å»ºçš„æª¢æŸ¥<code>python manage.py check --deploy</code>æœƒç™¼ç¾æ»¿æ»¿çš„security warningğŸ¤”</p>
<h3 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h3><p>ç¬¬ä¸€æ­¥æœƒæ˜¯å°‡debugçµ¦é—œæ‰ï¼Œä¹Ÿå°±æ˜¯æ”¹æˆ<code>False</code>ï¼Œé€™æœƒä½¿å¾—æˆ‘å€‘è£¡é¢çš„éœæ…‹æª”æ¡ˆéœ€è¦è¢«æ”¶é›†èµ·ä¾†ï¼Œä¸ç„¶gunicornä¸¦ä¸æœƒå»ä¸»å‹•ç”Ÿæˆæ”¶é›†ã€‚æ­¤æ™‚ä¹Ÿè¦å°‡æˆ‘å€‘<code>ALLOWED_HOSTS = [&#39;*&#39;]</code>ï¼Œå¦å‰‡æ˜¯æœƒå¾—åˆ°bad requestçš„å“¦ã€‚<br>å¾€å¾Œå¯ä»¥å°‡è£¡é ­åšæ›´æ”¹ï¼Œä¸Šç·šæ™‚ä¸æ‡‰è©²ä½¿ç”¨<code>[&#39;*&#39;]</code></p>
<p>æˆ‘å€‘é€²åˆ°settings.pyï¼ŒæŠŠ<code>DEBUG = False</code>ï¼Œä¸¦åœ¨æœ€ä¸‹é¢éœæ…‹æª”åŠ ä¸Š<code>STATIC_ROOT = BASE_DIR / &quot;staticfiles&quot;</code></p>
<p>é€™æ™‚å¾Œä¼ºæœå™¨æœƒå‘ˆç¾æ‰¾ä¸åˆ°reponseè³‡æ–™ï¼Œåœ¨æˆ‘å€‘æ”¶é›†ä¹‹å‰ï¼Œæˆ‘å€‘å°‡å…±ç”¨è³‡æ–™å¤¾å…ˆå¯«å…¥docker-composeè£¡ã€‚</p>
<figure class="highlight docker"><figcaption><span>Dockerfile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Deprecated. only informative now.</span></span><br><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    <span class="comment"># build should point to a directory containing the Dockerfile</span></span><br><span class="line">    build: ./</span><br><span class="line">    command: gunicorn deployment.wsgi:application --bind <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8000</span></span><br><span class="line">    volumes:</span><br><span class="line">      - static_volume:/home/app/web/staticfiles</span><br><span class="line">    <span class="keyword">expose</span>:</span><br><span class="line">      - <span class="number">8000</span></span><br><span class="line">    depends_on:</span><br><span class="line">      - db</span><br><span class="line">  db:</span><br><span class="line">    image: postgres:<span class="number">14</span></span><br><span class="line">    volumes:</span><br><span class="line">      - postgres_data:/var/lib/postgresql/data/</span><br><span class="line">    environment:</span><br><span class="line">      - POSTGRES_USER=tyler</span><br><span class="line">      - POSTGRES_PASSWORD=password</span><br><span class="line">      - POSTGRES_DB=deployment_db</span><br><span class="line">  nginx:</span><br><span class="line">    build: ./nginx</span><br><span class="line">    volumes:</span><br><span class="line">      - static_volume:/home/app/web/staticfiles</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="number">1337</span>:<span class="number">80</span></span><br><span class="line">    depends_on:</span><br><span class="line">      - web</span><br><span class="line">volumes:</span><br><span class="line">  postgres_data:</span><br><span class="line">  static_volume:</span><br></pre></td></tr></table></figure>

<p>æˆ‘å€‘æ–°å¢äº†static_volumeåœ¨webä»¥åŠnginxè£¡é¢ï¼Œç¢ºä¿éœæ…‹ç‰©ä»¶å¯ä»¥è¢«shareä½¿ç”¨ã€‚<br>æ¥è‘—æˆ‘å€‘å»ºç«‹è³‡æ–™å¤¾å­˜æ”¾ï¼Œåœ¨Dockerfileæˆ‘å€‘åŠ å…¥åº•ä¸‹é€™æ®µä¸¦åœ¨nginx.confæ–°å¢è·¯å¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># create the appropriate directories</span><br><span class="line">ENV HOME=/home/app</span><br><span class="line">ENV APP_HOME=/home/app/web</span><br><span class="line">RUN mkdir $APP_HOME</span><br><span class="line">RUN mkdir $APP_HOME/staticfiles</span><br><span class="line">WORKDIR $APP_HOME</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">upstream deployment &#123;</span><br><span class="line">    server web:8000;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">    listen 80;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://deployment;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">    &#125;</span><br><span class="line">    location /static/ &#123;</span><br><span class="line">        alias /home/app/web/staticfiles/;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<p>å…ˆæ­å–œå„ä½ï¼Œå¦‚æœä¸­é–“æ²’æœ‰å·®éŒ¯èµ°åˆ°é€™è£¡å·²ç¶“æˆåŠŸäº†å“¦ğŸ‰ğŸ‰</p>
<ul>
<li>è©¦è‘—ç”¨<code>docker-compose up -d --build</code>é‡å…ˆå»ºç«‹æˆ‘å€‘imageæª”æ¡ˆä¸¦ä¸”å•Ÿå‹•</li>
<li>æ­¤æ™‚æ‰“é–‹<code>localhost:1337</code>æ‡‰è©²æœƒå‘ˆç¾å¤±æ•—ç•«é¢</li>
<li>åŸ·è¡Œ<code>docker-compose exec web python manage.py migrate --noinput</code>å°‡æ›´æ”¹migrateé€²ä¾†</li>
<li>åŸ·è¡Œ<code>docker-compose exec web python manage.py collectstatic --no-input --clear</code>æ”¶é›†éœæ…‹æª”</li>
<li>é‡æ–°æ•´ç†å°±æœƒå¾—åˆ°æˆåŠŸçš„ç¶²ç«™å›‰</li>
</ul>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/users/20012434/ironman/3357">åŠ é€Ÿä½ çš„ Django ç¶²ç«™é–‹ç™¼ - Django çš„å¥½ç”¨å¥—ä»¶ç³»åˆ—</a><br><br><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/4.1/topics/class-based-views/intro/">Introduction to class-based views</a><br><br><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/renderers/">TemplateHTMLRenderer</a><br><br><a target="_blank" rel="noopener" href="https://django-allauth.readthedocs.io/en/latest/">django-allauth</a><br><a target="_blank" rel="noopener" href="https://dysonma.github.io/2021/01/27/Python-Unit-Testing-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6/">[Python] Unit Testing(å–®å…ƒæ¸¬è©¦)</a><br><br><a target="_blank" rel="noopener" href="https://testdriven.io/tips/9aee5b07-bf7a-475b-91cc-d46e8f5c512a/">how to disable the Browsable API in production</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Django/" rel="tag"># Django</a>
              <a href="/tags/Docker/" rel="tag"># Docker</a>
              <a href="/tags/Deployment/" rel="tag"># Deployment</a>
              <a href="/tags/Web-Development/" rel="tag"># Web Development</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/04/02/hexo-2/" rel="prev" title="Hexo token update">
                  <i class="fa fa-chevron-left"></i> Hexo token update
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/09/20/tlog2/" rel="next" title="Tlog#2 å¤©æ–‡ç¢©å£«è½‰è·å¾Œç«¯å·¥ç¨‹å¸«">
                  Tlog#2 å¤©æ–‡ç¢©å£«è½‰è·å¾Œç«¯å·¥ç¨‹å¸« <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






<script src="https://utteranc.es/client.js"
        repo="Tylerastro/Tylerastro.github.io"
        issue-term="title"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 â€“ 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Han Tang Lin</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Symbols count total">104k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:35</span>
  </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
